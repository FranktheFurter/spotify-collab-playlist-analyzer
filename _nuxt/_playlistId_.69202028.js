import{r as $,z as O,A as W,B as V,i as w,h as x,C as h,o as I,c as T,D as S,a as p,t as v,F as M,E as q,G as C,j as L,H as Q,I as N,q as X,J as F,K as j,L as Y,M as Z,f as R,u as K,k as ee,m as te,N as se,b as P}from"./entry.78244c48.js";const re=e=>{const t=$(null),{token:s,getAccessToken:r}=O(),a=async i=>{const c={method:"get",url:`https://api.spotify.com/v1/users/${e}`,headers:{Authorization:`Bearer ${i}`}};try{const d=await W(c);t.value=d.data}catch(d){console.error("Error getting user data",d)}};return(async()=>{s.value===""&&await r(),a(s.value)})(),{userData:t}},U=$([]),A=$(null),B=$([]),D=(e=null)=>{const{token:t,getAccessToken:s}=O(),r=async i=>{let c=0,d=null;do{const y={method:"get",url:`https://api.spotify.com/v1/playlists/${e}/tracks?offset=${c}`,headers:{Authorization:`Bearer ${i}`}};try{const m=await W(y);U.value.push(...m.data.items),d=m.data.total,c+=m.data.items.length}catch(m){console.error("Error getting tracks",m)}}while(c<d)},a=async i=>{const c={method:"get",url:`https://api.spotify.com/v1/playlists/${e}`,headers:{Authorization:`Bearer ${i}`}};try{const d=await W(c);A.value=d.data}catch(d){console.error("Error getting playlist information",d)}};return e&&(async()=>{U.value=[],A.value=[],B.value=[],t.value===""&&await s(),a(t.value),await r(t.value);const i=Array.from(new Set(U.value.map(c=>c.added_by.id)));for(let c of i){const{userData:d}=re(c);V(()=>d.value,y=>{y&&B.value.push(y)},{immediate:!0})}})(),{playlist:U,playlistInfo:A,usersData:B}},z=()=>{const{playlist:e,playlistInfo:t,usersData:s}=D(),r=()=>e.value.reduce((o,l)=>o+l.track.duration_ms,0),a=o=>{const l=s.value.find(u=>u.id===o);return l?l.display_name:""},n=o=>e.value.filter(l=>l.added_by.id===o).length,i=o=>e.value.filter(l=>l.added_by.id===o).reduce((l,u)=>l+u.track.duration_ms,0),c=o=>{const l=i(o),u=e.value.reduce((f,k)=>f+k.track.duration_ms,0);return l/u*100},d=o=>{const l=e.value.filter(f=>f.added_by.id===o);return l.length===0?0:l.reduce((f,k)=>f+k.track.popularity,0)/l.length},y=w(()=>{const o=e.value.reduce((f,k)=>(f[k.added_by.id]?f[k.added_by.id]+=1:f[k.added_by.id]=1,f),{});let l=null,u=0;for(const f in o)o[f]>u&&(u=o[f],l=f);return l}),m=w(()=>{const o=e.value.reduce((f,k)=>(f[k.added_by.id]?f[k.added_by.id]+=1:f[k.added_by.id]=1,f),{});let l=null,u=1/0;for(const f in o)o[f]<u&&(u=o[f],l=f);return l}),g=w(()=>{let o="",l=0;return e.value.forEach(u=>{u.track.duration_ms>l&&(l=u.track.duration_ms,o=u.added_by.id)}),o}),_=w(()=>{let o="",l=1/0;return e.value.forEach(u=>{u.track.duration_ms<l&&(l=u.track.duration_ms,o=u.added_by.id)}),o});return{getDisplayNameById:a,getTracksCountByUserId:n,getTotalTrackDurationByUserId:i,getTracksDurationInPercentageByUserId:c,getTotalPlaylistDuration:r,getAverageTrackPopularityByUserId:d,getUserIdWithMostTracks:y,getUserIdWithLeastTracks:m,getUserIdWithLongestTrack:g,getUserIdWithShortestTrack:_}},H=()=>({msToTime:t=>{if(typeof t!="number")return"00h 00m 00s";const s=Math.floor(t/1e3%60),r=Math.floor(t/(1e3*60)%60),a=Math.floor(t/(1e3*60*60)),n=i=>i<10?`0${i}`:i;return`${n(a)}h ${n(r)}m ${n(s)}s`}}),oe={key:0,class:"container mx-auto w-100% flex flex-col items-center mt-24 gap-8"},ie=["src"],ae=x({__name:"PlaylistInfo",setup(e){const{playlist:t,playlistInfo:s,usersData:r}=D(),{getTotalPlaylistDuration:a}=z(),{msToTime:n}=H();return(i,c)=>h(s)?(I(),T("div",oe,[h(s).images&&h(s).images.length>0?(I(),T("img",{key:0,src:h(s).images[0].url,alt:"Playlist cover image",width:"300",height:"300"},null,8,ie)):S("",!0),p("h1",null,v(h(s).name)+" "+v(h(n)(h(a)())),1),p("h2",null,v(h(s).description),1)])):S("",!0)}}),ne={key:0,class:"flex flex-col items-center gap-1 border-gray/20 border-solid border-rounded-xl p-4"},ce=["src"],le={key:1,class:"w-60px h-60px bg-gray rounded-full"},de={class:"mt-2"},ue={class:"opacity-80"},fe={class:"opacity-80"},ge={class:"opacity-80"},he={class:"opacity-80"},me=x({__name:"UserPanel",props:{userData:Object},setup(e){const t=e,{getTotalTrackDurationByUserId:s,getTracksCountByUserId:r,getTracksDurationInPercentageByUserId:a,getAverageTrackPopularityByUserId:n}=z(),{msToTime:i}=H(),c=t.userData.id,d=r(c),y=a(c),m=s(c),g=n(c),_=w(()=>i(m));return(o,l)=>{var u,f;return e.userData?(I(),T("div",ne,[e.userData.images&&e.userData.images.length>0?(I(),T("img",{key:0,class:"rounded-full",src:e.userData.images[0].url,alt:"User profile image",width:"60",height:"60"},null,8,ce)):(I(),T("div",le)),p("div",de,v(e.userData.display_name),1),p("div",ue,v(h(d)),1),p("div",fe,v(h(_)),1),p("div",ge,v((u=h(y))==null?void 0:u.toFixed(2))+" % Playtime",1),p("div",he,v((f=h(g))==null?void 0:f.toFixed(0))+" popularity",1)])):S("",!0)}}}),pe=p("div",{class:"container mx-auto"},[p("h2",null,"Teilnehmer")],-1),ye={class:"container mx-auto grid grid-cols-2 md:grid-cols-3 xl:grid-cols-6 gap-4 py-8"},_e={class:"container mx-auto"},ve=p("h2",null,"User Awards:",-1),we=p("h3",null,"Most Tracks:",-1),Ie=p("h3",null,"Least Tracks:",-1),ke=p("h3",null,"Longest Track:",-1),Te=p("h3",null,"Shortest Track:",-1),be=x({__name:"Users",setup(e){const{usersData:t}=D(),{getDisplayNameById:s,getUserIdWithMostTracks:r,getUserIdWithLeastTracks:a,getUserIdWithLongestTrack:n,getUserIdWithShortestTrack:i}=z();return(c,d)=>{const y=me;return I(),T(M,null,[pe,p("div",ye,[(I(!0),T(M,null,q(h(t),(m,g)=>(I(),C(y,{key:g,"user-data":m},null,8,["user-data"]))),128))]),p("div",_e,[ve,we,p("p",null,v(h(r)?h(s)(h(r)):"No user found"),1),Ie,p("p",null,v(h(a)?h(s)(h(a)):"No user found"),1),ke,p("p",null,v(h(a)?h(s)(h(n)):"No user found"),1),Te,p("p",null,v(h(a)?h(s)(h(i)):"No user found"),1)])],64)}}});async function $e(e,t){return await xe(t).catch(r=>(console.error("Failed to get image meta for "+t,r+""),{width:0,height:0,ratio:0}))}async function xe(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,s)=>{const r=new Image;r.onload=()=>{const a={width:r.width,height:r.height,ratio:r.width/r.height};t(a)},r.onerror=a=>s(a),r.src=e})}function E(e){return t=>t?e[t]||t:e.missingValue}function Se({formatter:e,keyMap:t,joinWith:s="/",valueMap:r}={}){e||(e=(n,i)=>`${n}=${i}`),t&&typeof t!="function"&&(t=E(t));const a=r||{};return Object.keys(a).forEach(n=>{typeof a[n]!="function"&&(a[n]=E(a[n]))}),(n={})=>Object.entries(n).filter(([c,d])=>typeof d<"u").map(([c,d])=>{const y=a[c];return typeof y=="function"&&(d=y(n[c])),c=typeof t=="function"?t(c):c,e(c,d)}).join(s)}function b(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return parseInt(e,10)}function De(e){const t={options:e},s=(a,n={})=>G(t,a,n),r=(a,n={},i={})=>s(a,{...i,modifiers:F(n,i.modifiers||{})}).url;for(const a in e.presets)r[a]=(n,i,c)=>r(n,i,{...e.presets[a],...c});return r.options=e,r.getImage=s,r.getMeta=(a,n)=>ze(t,a,n),r.getSizes=(a,n)=>Ae(t,a,n),t.$img=r,r}async function ze(e,t,s){const r=G(e,t,{...s});return typeof r.getMeta=="function"?await r.getMeta():await $e(e,r.url)}function G(e,t,s){var y,m;if(typeof t!="string"||t==="")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(t.startsWith("data:"))return{url:t};const{provider:r,defaults:a}=Ue(e,s.provider||e.options.provider),n=Pe(e,s.preset);if(t=L(t)?t:Q(t),!r.supportsAlias)for(const g in e.options.alias)t.startsWith(g)&&(t=N(e.options.alias[g],t.substr(g.length)));if(r.validateDomains&&L(t)){const g=X(t).host;if(!e.options.domains.find(_=>_===g))return{url:t}}const i=F(s,n,a);i.modifiers={...i.modifiers};const c=i.modifiers.format;(y=i.modifiers)!=null&&y.width&&(i.modifiers.width=b(i.modifiers.width)),(m=i.modifiers)!=null&&m.height&&(i.modifiers.height=b(i.modifiers.height));const d=r.getImage(t,i,e);return d.format=d.format||c||"",d}function Ue(e,t){const s=e.options.providers[t];if(!s)throw new Error("Unknown provider: "+t);return s}function Pe(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function Ae(e,t,s){var y,m;const r=b((y=s.modifiers)==null?void 0:y.width),a=b((m=s.modifiers)==null?void 0:m.height),n=r&&a?a/r:0,i=[],c={};if(typeof s.sizes=="string")for(const g of s.sizes.split(/[\s,]+/).filter(_=>_)){const _=g.split(":");_.length===2&&(c[_[0].trim()]=_[1].trim())}else Object.assign(c,s.sizes);for(const g in c){const _=e.options.screens&&e.options.screens[g]||parseInt(g);let o=String(c[g]);const l=o.endsWith("vw");if(!l&&/^\d+$/.test(o)&&(o=o+"px"),!l&&!o.endsWith("px"))continue;let u=parseInt(o);if(!_||!u)continue;l&&(u=Math.round(u/100*_));const f=n?Math.round(u*n):a;i.push({width:u,size:o,screenMaxWidth:_,media:`(max-width: ${_}px)`,src:e.$img(t,{...s.modifiers,width:u,height:f},s)})}i.sort((g,_)=>g.screenMaxWidth-_.screenMaxWidth);const d=i[i.length-1];return d&&(d.media=""),{sizes:i.map(g=>`${g.media?g.media+" ":""}${g.size}`).join(", "),srcset:i.map(g=>`${g.src} ${g.width}w`).join(", "),src:d==null?void 0:d.src}}const Be=Se({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,t)=>j(e)+"_"+j(t)}),We=(e,{modifiers:t={},baseURL:s}={},r)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const a=Be(t)||"_";return s||(s=N(r.options.nuxt.baseURL,"/_ipx")),{url:N(s,a,Y(e))}},Me=!0,Ne=!0,Le=Object.freeze(Object.defineProperty({__proto__:null,getImage:We,supportsAlias:Ne,validateDomains:Me},Symbol.toStringTag,{value:"Module"})),J={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipx",domains:[],alias:{}};J.providers={ipx:{provider:Le,defaults:void 0}};const je=()=>{const e=Z(),t=R();return t.$img||t._img||(t._img=De({...J,nuxt:{baseURL:e.app.baseURL}}))},Ee={src:{type:String,required:!0},format:{type:String,default:void 0},quality:{type:[Number,String],default:void 0},background:{type:String,default:void 0},fit:{type:String,default:void 0},modifiers:{type:Object,default:void 0},preset:{type:String,default:void 0},provider:{type:String,default:void 0},sizes:{type:[Object,String],default:void 0},preload:{type:Boolean,default:void 0},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0},alt:{type:String,default:void 0},referrerpolicy:{type:String,default:void 0},usemap:{type:String,default:void 0},longdesc:{type:String,default:void 0},ismap:{type:Boolean,default:void 0},loading:{type:String,default:void 0},crossorigin:{type:[Boolean,String],default:void 0,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,default:void 0,validator:e=>["async","auto","sync"].includes(e)}},Oe=e=>{const t=w(()=>({provider:e.provider,preset:e.preset})),s=w(()=>({width:b(e.width),height:b(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding})),r=w(()=>({...e.modifiers,width:b(e.width),height:b(e.height),format:e.format,quality:e.quality,background:e.background,fit:e.fit}));return{options:t,attrs:s,modifiers:r}},qe={...Ee,placeholder:{type:[Boolean,String,Number,Array],default:void 0}},Ce=x({name:"NuxtImg",props:qe,emits:["load","error"],setup:(e,t)=>{const s=je(),r=Oe(e),a=$(!1),n=w(()=>s.getSizes(e.src,{...r.options.value,sizes:e.sizes,modifiers:{...r.modifiers.value,width:b(e.width),height:b(e.height)}})),i=w(()=>{const o={...r.attrs.value,"data-nuxt-img":""};return e.sizes&&(o.sizes=n.value.sizes,o.srcset=n.value.srcset),o}),c=w(()=>{let o=e.placeholder;if(o===""&&(o=!0),!o||a.value)return!1;if(typeof o=="string")return o;const l=Array.isArray(o)?o:typeof o=="number"?[o,o]:[10,10];return s(e.src,{...r.modifiers.value,width:l[0],height:l[1],quality:l[2]||50},r.options.value)}),d=w(()=>e.sizes?n.value.src:s(e.src,r.modifiers.value,r.options.value)),y=w(()=>c.value?c.value:d.value);if(e.preload){const o=Object.values(n.value).every(l=>l);K({link:[{rel:"preload",as:"image",...o?{href:n.value.src,imagesizes:n.value.sizes,imagesrcset:n.value.srcset}:{href:y.value}}]})}const m=$(),_=R().isHydrating;return ee(()=>{if(c.value){const o=new Image;o.src=d.value,o.onload=l=>{m.value&&(m.value.src=d.value),a.value=!0,t.emit("load",l)};return}m.value&&(m.value.complete&&_&&(m.value.getAttribute("data-error")?t.emit("error",new Event("error")):t.emit("load",new Event("load"))),m.value.onload=o=>{t.emit("load",o)},m.value.onerror=o=>{t.emit("error",o)})}),()=>te("img",{ref:m,key:y.value,src:y.value,...i.value,...t.attrs})}}),Fe={key:0,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2 md:gap-4 container mx-auto"},Re={class:"px-2 text-white/80 text-xs backdrop-blur-2xl border-solid border-white/20 w-100% md:w-unset"},He={class:"line-clamp-1"},Ge={class:"line-clamp-1"},Je=x({__name:"TrackList",setup(e){const{playlist:t}=D();z();const s=r=>r.map(a=>a.name).join(", ");return(r,a)=>{const n=Ce;return h(t)?(I(),T("div",Fe,[(I(!0),T(M,null,q(h(t),(i,c)=>(I(),T("div",{key:c,class:"w-100% flex md:flex-col bg-opacity-10"},[i.track.album.images&&i.track.album.images[0]?(I(),C(n,{key:0,src:i.track.album.images[0].url,alt:"cover",loading:"lazy",class:"object-contain w-20 md:w-100% aspect-1/1"},null,8,["src"])):S("",!0),p("div",Re,[p("p",He,v(i.track.name),1),p("p",Ge,v(s(i.track.artists)),1)])]))),128))])):S("",!0)}}}),Ve={class:""},Qe={class:"py-4"},Ye=x({__name:"[playlistId]",setup(e){const s=se().params.playlistId;return D(s),z(),(r,a)=>{const n=ae,i=be,c=Je;return I(),T("div",null,[p("div",Ve,[P(n),P(i),p("div",Qe,[P(c)])])])}}});export{Ye as default};
