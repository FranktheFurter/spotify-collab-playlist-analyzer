import{r as P,z as ve,A as N,B as Pe,i as I,h as D,C as s,o as b,c as T,D as $,a as p,t as m,F as L,E as ke,G as be,j as pe,H as De,I as j,q as Ue,J as we,K as ye,L as ze,M as We,f as Te,u as Me,k as Ae,m as Be,N as Ne,b as M}from"./entry.9d6890c5.js";const Le=e=>{const t=P(null),{token:r,getAccessToken:o}=ve(),c=async a=>{const n={method:"get",url:`https://api.spotify.com/v1/users/${e}`,headers:{Authorization:`Bearer ${a}`}};try{const l=await N(n);t.value=l.data}catch(l){console.error("Error getting user data",l)}};return(async()=>{r.value===""&&await o(),c(r.value)})(),{userData:t}},W=P([]),A=P(null),B=P([]),U=(e=null)=>{const{token:t,getAccessToken:r}=ve(),o=async a=>{let n=0,l=null;do{const v={method:"get",url:`https://api.spotify.com/v1/playlists/${e}/tracks?offset=${n}`,headers:{Authorization:`Bearer ${a}`}};try{const y=await N(v);W.value.push(...y.data.items),l=y.data.total,n+=y.data.items.length}catch(y){console.error("Error getting tracks",y)}}while(n<l)},c=async a=>{const n={method:"get",url:`https://api.spotify.com/v1/playlists/${e}`,headers:{Authorization:`Bearer ${a}`}};try{const l=await N(n);A.value=l.data}catch(l){console.error("Error getting playlist information",l)}};return e&&(async()=>{W.value=[],A.value=[],B.value=[],t.value===""&&await r(),c(t.value),await o(t.value);const a=Array.from(new Set(W.value.map(n=>n.added_by.id)));for(let n of a){const{userData:l}=Le(n);Pe(()=>l.value,v=>{v&&B.value.push(v)},{immediate:!0})}})(),{playlist:W,playlistInfo:A,usersData:B}},z=()=>{const{playlist:e,playlistInfo:t,usersData:r}=U(),o=()=>e.value.reduce((u,d)=>u+d.track.duration_ms,0),c=u=>{const d=r.value.find(f=>f.id===u);return d?d.display_name:""},i=u=>e.value.filter(d=>d.added_by.id===u).length,a=u=>e.value.filter(d=>d.added_by.id===u).reduce((d,f)=>d+f.track.duration_ms,0),n=u=>{const d=a(u),f=e.value.reduce((g,x)=>g+x.track.duration_ms,0);return d/f*100},l=u=>{const d=e.value.filter(g=>g.added_by.id===u);return d.length===0?0:d.reduce((g,x)=>g+x.track.popularity,0)/d.length},v=I(()=>{const u=e.value.reduce((g,x)=>(g[x.added_by.id]?g[x.added_by.id]+=1:g[x.added_by.id]=1,g),{});let d=null,f=0;for(const g in u)u[g]>f&&(f=u[g],d=g);return{user:r.value.find(g=>g.id===d),tracksCount:f}}),y=I(()=>{const u=e.value.reduce((g,x)=>(g[x.added_by.id]?g[x.added_by.id]+=1:g[x.added_by.id]=1,g),{});let d=null,f=1/0;for(const g in u)u[g]<f&&(f=u[g],d=g);return{user:r.value.find(g=>g.id===d),tracksCount:f}}),_=I(()=>{let u="",d=null;return e.value.forEach(f=>{f.track.duration_ms>(d?d.track.duration_ms:0)&&(d=f,u=f.added_by.id)}),{user:r.value.find(f=>f.id===u),track:d}}),k=I(()=>{let u="",d=null;return e.value.forEach(f=>{f.track.duration_ms<(d?d.track.duration_ms:1/0)&&(d=f,u=f.added_by.id)}),{user:r.value.find(f=>f.id===u),track:d}}),h=I(()=>{let u="",d=null;return e.value.forEach(f=>{f.track.popularity>(d?d.track.popularity:-1/0)&&(d=f,u=f.added_by.id)}),{user:r.value.find(f=>f.id===u),track:d}}),w=I(()=>{let u="",d=null;return e.value.forEach(f=>{f.track.popularity<(d?d.track.popularity:1/0)&&(d=f,u=f.added_by.id)}),{user:r.value.find(f=>f.id===u),track:d}});return{getDisplayNameById:c,getTracksCountByUserId:i,getTotalTrackDurationByUserId:a,getTracksDurationInPercentageByUserId:n,getTotalPlaylistDuration:o,getAverageTrackPopularityByUserId:l,getUserWithMostTracks:v,getUserIdWithLeastTracks:y,getUserWithLongestTrack:_,getUserWithShortestTrack:k,getUserWithMostPopularTrack:h,getUserWithLeastPopularTrack:w}},E=()=>({msToTime:r=>{if(typeof r!="number")return"00h 00m 00s";const o=Math.floor(r/1e3%60),c=Math.floor(r/(1e3*60)%60),i=Math.floor(r/(1e3*60*60)),a=n=>n<10?`0${n}`:n;return`${a(i)}h ${a(c)}m ${a(o)}s`},msToTimeShort:r=>{if(typeof r!="number")return"00:00";const o=Math.floor(r/1e3%60),c=Math.floor(r/(1e3*60)),i=a=>a<10?`0${a}`:a;return`${i(c)}:${i(o)}`}}),je={key:0,class:"container mx-auto w-100% flex flex-col items-center mt-24 gap-8"},Ee=["src"],Ce=D({__name:"PlaylistInfo",setup(e){const{playlist:t,playlistInfo:r,usersData:o}=U(),{getTotalPlaylistDuration:c}=z(),{msToTime:i}=E();return(a,n)=>s(r)?(b(),T("div",je,[s(r).images&&s(r).images.length>0?(b(),T("img",{key:0,src:s(r).images[0].url,alt:"Playlist cover image",width:"300",height:"300"},null,8,Ee)):$("",!0),p("h1",null,m(s(r).name)+" "+m(s(i)(s(c)())),1),p("h2",null,m(s(r).description),1)])):$("",!0)}}),Oe={key:0,class:"flex flex-col items-center gap-1 border-gray/20 border-solid border-rounded-xl p-4"},qe=["src"],Fe={key:1,class:"w-60px h-60px bg-gray rounded-full"},Re={class:"mt-2"},He={class:"opacity-80"},Ge={class:"opacity-80"},Je={class:"opacity-80"},Ve={class:"opacity-80"},Qe=D({__name:"UserPanel",props:{userData:Object},setup(e){const t=e,{getTotalTrackDurationByUserId:r,getTracksCountByUserId:o,getTracksDurationInPercentageByUserId:c,getAverageTrackPopularityByUserId:i}=z(),{msToTime:a}=E(),n=t.userData.id,l=o(n),v=c(n),y=r(n),_=i(n),k=I(()=>a(y));return(h,w)=>{var u,d;return e.userData?(b(),T("div",Oe,[e.userData.images&&e.userData.images.length>0?(b(),T("img",{key:0,class:"rounded-full",src:e.userData.images[0].url,alt:"User profile image",width:"60",height:"60"},null,8,qe)):(b(),T("div",Fe)),p("div",Re,m(e.userData.display_name),1),p("div",He,m(s(l)),1),p("div",Ge,m(s(k)),1),p("div",Je,m((u=s(v))==null?void 0:u.toFixed(2))+" % Playtime",1),p("div",Ve,m((d=s(_))==null?void 0:d.toFixed(0))+" popularity",1)])):$("",!0)}}}),Xe=p("div",{class:"container mx-auto"},[p("h2",null,"Teilnehmer")],-1),Ye={class:"container mx-auto grid grid-cols-2 md:grid-cols-3 xl:grid-cols-6 gap-4 py-8"},Ze=p("h2",{class:"container mx-auto"},"Awards:",-1),Ke={class:"container mx-auto grid grid-cols-2 lg:grid-cols-4 gap-4"},et={key:0,class:"border-gray/40 border-solid border-rounded-xl p-2"},tt=p("h3",null,"Most Tracks:",-1),rt={key:1,class:"border-gray/40 border-solid border-rounded-xl p-2"},st=p("h3",null,"Least Tracks:",-1),ot={key:2,class:"border-gray/40 border-solid border-rounded-xl p-2"},at=p("h3",null,"Longest Track:",-1),it={key:3,class:"border-gray/40 border-solid border-rounded-xl p-2"},nt=p("h3",null,"Shortest Track:",-1),ct={key:4,class:"border-gray/40 border-solid border-rounded-xl p-2"},dt=p("h3",null,"Mainstream Manfred:",-1),lt={key:5,class:"border-gray/40 border-solid border-rounded-xl p-2"},ut=p("h3",null,"Underground Uwe:",-1),ft=D({__name:"Users",setup(e){const{usersData:t}=U(),{getDisplayNameById:r,getUserWithMostTracks:o,getUserIdWithLeastTracks:c,getUserWithLongestTrack:i,getUserWithShortestTrack:a,getUserWithMostPopularTrack:n,getUserWithLeastPopularTrack:l}=z(),{msToTime:v,msToTimeShort:y}=E();return(_,k)=>{var w,u,d,f,g,x,C,O,q,F,R,H,G,J,V,Q,X,Y,Z,K,ee,te,re,se,oe,ae,ie,ne,ce,de,le,ue,fe,he,ge,me;const h=Qe;return b(),T(L,null,[Xe,p("div",Ye,[(b(!0),T(L,null,ke(s(t),($e,Se)=>(b(),be(h,{key:Se,"user-data":$e},null,8,["user-data"]))),128))]),Ze,p("div",Ke,[s(o)&&s(o).tracksCount&&s(o).user&&s(o).user.id?(b(),T("div",et,[tt,p("p",null,m(s(o)?s(r)(s(o).user.id):"No user found")+" with: "+m(s(o).tracksCount)+" tracks ",1)])):$("",!0),s(c)&&s(c).tracksCount&&s(c).user&&s(c).user.id?(b(),T("div",rt,[st,p("p",null,m(s(c)?s(r)(s(c).user.id):"No user found")+" with: "+m(s(c).tracksCount)+" tracks ",1)])):$("",!0),s(i)&&s(i).track&&s(i).user&&s(i).user.id?(b(),T("div",ot,[at,p("p",null,m(s(i)?s(r)(s(i).user.id):"No user found")+" with: "+m(((d=(u=(w=s(i))==null?void 0:w.track)==null?void 0:u.track)==null?void 0:d.name)??"")+" by "+m(((x=(g=(f=s(i))==null?void 0:f.track)==null?void 0:g.track)==null?void 0:x.artists[0].name)??"")+" with: "+m(s(y)((q=(O=(C=s(i))==null?void 0:C.track)==null?void 0:O.track)==null?void 0:q.duration_ms)),1)])):$("",!0),s(a)&&s(a).track&&s(a).user&&s(a).user.id?(b(),T("div",it,[nt,p("p",null,m(s(a)?s(r)(s(a).user.id):"No user found")+" with: "+m(((H=(R=(F=s(a))==null?void 0:F.track)==null?void 0:R.track)==null?void 0:H.name)??"")+" by "+m(((V=(J=(G=s(a))==null?void 0:G.track)==null?void 0:J.track)==null?void 0:V.artists[0].name)??"")+" with: "+m(s(y)((Y=(X=(Q=s(a))==null?void 0:Q.track)==null?void 0:X.track)==null?void 0:Y.duration_ms)),1)])):$("",!0),s(n)&&s(n).track&&s(n).user&&s(n).user.id?(b(),T("div",ct,[dt,p("p",null,m(s(n)?s(r)(s(n).user.id):"No user found")+" with: "+m(((ee=(K=(Z=s(n))==null?void 0:Z.track)==null?void 0:K.track)==null?void 0:ee.name)??"")+" by "+m(((se=(re=(te=s(n))==null?void 0:te.track)==null?void 0:re.track)==null?void 0:se.artists[0].name)??"")+" with: "+m((ie=(ae=(oe=s(n))==null?void 0:oe.track)==null?void 0:ae.track)==null?void 0:ie.popularity)+" popularity ",1)])):$("",!0),s(l)&&s(l).track&&s(l).user&&s(l).user.id?(b(),T("div",lt,[ut,p("p",null,m(s(l)?s(r)(s(l).user.id):"No user found")+" with: "+m(((de=(ce=(ne=s(l))==null?void 0:ne.track)==null?void 0:ce.track)==null?void 0:de.name)??"")+" by "+m(((fe=(ue=(le=s(l))==null?void 0:le.track)==null?void 0:ue.track)==null?void 0:fe.artists[0].name)??"")+" with: "+m((me=(ge=(he=s(l))==null?void 0:he.track)==null?void 0:ge.track)==null?void 0:me.popularity)+" popularity ",1)])):$("",!0)])],64)}}});async function ht(e,t){return await gt(t).catch(o=>(console.error("Failed to get image meta for "+t,o+""),{width:0,height:0,ratio:0}))}async function gt(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,r)=>{const o=new Image;o.onload=()=>{const c={width:o.width,height:o.height,ratio:o.width/o.height};t(c)},o.onerror=c=>r(c),o.src=e})}function _e(e){return t=>t?e[t]||t:e.missingValue}function mt({formatter:e,keyMap:t,joinWith:r="/",valueMap:o}={}){e||(e=(i,a)=>`${i}=${a}`),t&&typeof t!="function"&&(t=_e(t));const c=o||{};return Object.keys(c).forEach(i=>{typeof c[i]!="function"&&(c[i]=_e(c[i]))}),(i={})=>Object.entries(i).filter(([n,l])=>typeof l<"u").map(([n,l])=>{const v=c[n];return typeof v=="function"&&(l=v(i[n])),n=typeof t=="function"?t(n):n,e(n,l)}).join(r)}function S(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return parseInt(e,10)}function pt(e){const t={options:e},r=(c,i={})=>Ie(t,c,i),o=(c,i={},a={})=>r(c,{...a,modifiers:we(i,a.modifiers||{})}).url;for(const c in e.presets)o[c]=(i,a,n)=>o(i,a,{...e.presets[c],...n});return o.options=e,o.getImage=r,o.getMeta=(c,i)=>yt(t,c,i),o.getSizes=(c,i)=>kt(t,c,i),t.$img=o,o}async function yt(e,t,r){const o=Ie(e,t,{...r});return typeof o.getMeta=="function"?await o.getMeta():await ht(e,o.url)}function Ie(e,t,r){var v,y;if(typeof t!="string"||t==="")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(t.startsWith("data:"))return{url:t};const{provider:o,defaults:c}=_t(e,r.provider||e.options.provider),i=vt(e,r.preset);if(t=pe(t)?t:De(t),!o.supportsAlias)for(const _ in e.options.alias)t.startsWith(_)&&(t=j(e.options.alias[_],t.substr(_.length)));if(o.validateDomains&&pe(t)){const _=Ue(t).host;if(!e.options.domains.find(k=>k===_))return{url:t}}const a=we(r,i,c);a.modifiers={...a.modifiers};const n=a.modifiers.format;(v=a.modifiers)!=null&&v.width&&(a.modifiers.width=S(a.modifiers.width)),(y=a.modifiers)!=null&&y.height&&(a.modifiers.height=S(a.modifiers.height));const l=o.getImage(t,a,e);return l.format=l.format||n||"",l}function _t(e,t){const r=e.options.providers[t];if(!r)throw new Error("Unknown provider: "+t);return r}function vt(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function kt(e,t,r){var v,y;const o=S((v=r.modifiers)==null?void 0:v.width),c=S((y=r.modifiers)==null?void 0:y.height),i=o&&c?c/o:0,a=[],n={};if(typeof r.sizes=="string")for(const _ of r.sizes.split(/[\s,]+/).filter(k=>k)){const k=_.split(":");k.length===2&&(n[k[0].trim()]=k[1].trim())}else Object.assign(n,r.sizes);for(const _ in n){const k=e.options.screens&&e.options.screens[_]||parseInt(_);let h=String(n[_]);const w=h.endsWith("vw");if(!w&&/^\d+$/.test(h)&&(h=h+"px"),!w&&!h.endsWith("px"))continue;let u=parseInt(h);if(!k||!u)continue;w&&(u=Math.round(u/100*k));const d=i?Math.round(u*i):c;a.push({width:u,size:h,screenMaxWidth:k,media:`(max-width: ${k}px)`,src:e.$img(t,{...r.modifiers,width:u,height:d},r)})}a.sort((_,k)=>_.screenMaxWidth-k.screenMaxWidth);const l=a[a.length-1];return l&&(l.media=""),{sizes:a.map(_=>`${_.media?_.media+" ":""}${_.size}`).join(", "),srcset:a.map(_=>`${_.src} ${_.width}w`).join(", "),src:l==null?void 0:l.src}}const bt=mt({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,t)=>ye(e)+"_"+ye(t)}),wt=(e,{modifiers:t={},baseURL:r}={},o)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const c=bt(t)||"_";return r||(r=j(o.options.nuxt.baseURL,"/_ipx")),{url:j(r,c,ze(e))}},Tt=!0,It=!0,xt=Object.freeze(Object.defineProperty({__proto__:null,getImage:wt,supportsAlias:It,validateDomains:Tt},Symbol.toStringTag,{value:"Module"})),xe={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipx",domains:[],alias:{}};xe.providers={ipx:{provider:xt,defaults:void 0}};const $t=()=>{const e=We(),t=Te();return t.$img||t._img||(t._img=pt({...xe,nuxt:{baseURL:e.app.baseURL}}))},St={src:{type:String,required:!0},format:{type:String,default:void 0},quality:{type:[Number,String],default:void 0},background:{type:String,default:void 0},fit:{type:String,default:void 0},modifiers:{type:Object,default:void 0},preset:{type:String,default:void 0},provider:{type:String,default:void 0},sizes:{type:[Object,String],default:void 0},preload:{type:Boolean,default:void 0},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0},alt:{type:String,default:void 0},referrerpolicy:{type:String,default:void 0},usemap:{type:String,default:void 0},longdesc:{type:String,default:void 0},ismap:{type:Boolean,default:void 0},loading:{type:String,default:void 0},crossorigin:{type:[Boolean,String],default:void 0,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,default:void 0,validator:e=>["async","auto","sync"].includes(e)}},Pt=e=>{const t=I(()=>({provider:e.provider,preset:e.preset})),r=I(()=>({width:S(e.width),height:S(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding})),o=I(()=>({...e.modifiers,width:S(e.width),height:S(e.height),format:e.format,quality:e.quality,background:e.background,fit:e.fit}));return{options:t,attrs:r,modifiers:o}},Dt={...St,placeholder:{type:[Boolean,String,Number,Array],default:void 0}},Ut=D({name:"NuxtImg",props:Dt,emits:["load","error"],setup:(e,t)=>{const r=$t(),o=Pt(e),c=P(!1),i=I(()=>r.getSizes(e.src,{...o.options.value,sizes:e.sizes,modifiers:{...o.modifiers.value,width:S(e.width),height:S(e.height)}})),a=I(()=>{const h={...o.attrs.value,"data-nuxt-img":""};return e.sizes&&(h.sizes=i.value.sizes,h.srcset=i.value.srcset),h}),n=I(()=>{let h=e.placeholder;if(h===""&&(h=!0),!h||c.value)return!1;if(typeof h=="string")return h;const w=Array.isArray(h)?h:typeof h=="number"?[h,h]:[10,10];return r(e.src,{...o.modifiers.value,width:w[0],height:w[1],quality:w[2]||50},o.options.value)}),l=I(()=>e.sizes?i.value.src:r(e.src,o.modifiers.value,o.options.value)),v=I(()=>n.value?n.value:l.value);if(e.preload){const h=Object.values(i.value).every(w=>w);Me({link:[{rel:"preload",as:"image",...h?{href:i.value.src,imagesizes:i.value.sizes,imagesrcset:i.value.srcset}:{href:v.value}}]})}const y=P(),k=Te().isHydrating;return Ae(()=>{if(n.value){const h=new Image;h.src=l.value,h.onload=w=>{y.value&&(y.value.src=l.value),c.value=!0,t.emit("load",w)};return}y.value&&(y.value.complete&&k&&(y.value.getAttribute("data-error")?t.emit("error",new Event("error")):t.emit("load",new Event("load"))),y.value.onload=h=>{t.emit("load",h)},y.value.onerror=h=>{t.emit("error",h)})}),()=>Be("img",{ref:y,key:v.value,src:v.value,...a.value,...t.attrs})}}),zt={key:0,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2 md:gap-4 container mx-auto"},Wt={class:"px-2 text-white/80 text-xs backdrop-blur-2xl border-solid border-white/20 w-100% md:w-unset"},Mt={class:"line-clamp-1"},At={class:"line-clamp-1"},Bt=D({__name:"TrackList",setup(e){const{playlist:t}=U();z();const r=o=>o.map(c=>c.name).join(", ");return(o,c)=>{const i=Ut;return s(t)?(b(),T("div",zt,[(b(!0),T(L,null,ke(s(t),(a,n)=>(b(),T("div",{key:n,class:"w-100% flex md:flex-col bg-opacity-10"},[a.track.album.images&&a.track.album.images[0]?(b(),be(i,{key:0,src:a.track.album.images[0].url,alt:"cover",loading:"lazy",class:"object-contain w-20 md:w-100% aspect-1/1"},null,8,["src"])):$("",!0),p("div",Wt,[p("p",Mt,m(a.track.name),1),p("p",At,m(r(a.track.artists)),1)])]))),128))])):$("",!0)}}}),Nt={class:""},Lt={class:"py-4"},Et=D({__name:"[playlistId]",setup(e){const r=Ne().params.playlistId;return U(r),z(),(o,c)=>{const i=Ce,a=ft,n=Bt;return b(),T("div",null,[p("div",Nt,[M(i),M(a),p("div",Lt,[M(n)])])])}}});export{Et as default};
