import{r as x,z as K,A as W,B as ce,i as T,h as S,C as c,o as k,c as w,D as $,a as p,t as v,F as M,E as ee,G as te,j as X,H as de,I as N,q as le,J as se,K as Y,L as ue,M as fe,f as re,u as ge,k as he,m as me,N as pe,b as U}from"./entry.7cf8ec38.js";const ye=e=>{const t=x(null),{token:s,getAccessToken:r}=K(),n=async o=>{const d={method:"get",url:`https://api.spotify.com/v1/users/${e}`,headers:{Authorization:`Bearer ${o}`}};try{const f=await W(d);t.value=f.data}catch(f){console.error("Error getting user data",f)}};return(async()=>{s.value===""&&await r(),n(s.value)})(),{userData:t}},P=x([]),A=x(null),B=x([]),D=(e=null)=>{const{token:t,getAccessToken:s}=K(),r=async o=>{let d=0,f=null;do{const _={method:"get",url:`https://api.spotify.com/v1/playlists/${e}/tracks?offset=${d}`,headers:{Authorization:`Bearer ${o}`}};try{const m=await W(_);P.value.push(...m.data.items),f=m.data.total,d+=m.data.items.length}catch(m){console.error("Error getting tracks",m)}}while(d<f)},n=async o=>{const d={method:"get",url:`https://api.spotify.com/v1/playlists/${e}`,headers:{Authorization:`Bearer ${o}`}};try{const f=await W(d);A.value=f.data}catch(f){console.error("Error getting playlist information",f)}};return e&&(async()=>{P.value=[],A.value=[],B.value=[],t.value===""&&await s(),n(t.value),await r(t.value);const o=Array.from(new Set(P.value.map(d=>d.added_by.id)));for(let d of o){const{userData:f}=ye(d);ce(()=>f.value,_=>{_&&B.value.push(_)},{immediate:!0})}})(),{playlist:P,playlistInfo:A,usersData:B}},z=()=>{const{playlist:e,playlistInfo:t,usersData:s}=D(),r=()=>e.value.reduce((a,l)=>a+l.track.duration_ms,0),n=a=>{const l=s.value.find(u=>u.id===a);return l?l.display_name:""},i=a=>e.value.filter(l=>l.added_by.id===a).length,o=a=>e.value.filter(l=>l.added_by.id===a).reduce((l,u)=>l+u.track.duration_ms,0),d=a=>{const l=o(a),u=e.value.reduce((g,b)=>g+b.track.duration_ms,0);return l/u*100},f=a=>{const l=e.value.filter(g=>g.added_by.id===a);return l.length===0?0:l.reduce((g,b)=>g+b.track.popularity,0)/l.length},_=T(()=>{const a=e.value.reduce((g,b)=>(g[b.added_by.id]?g[b.added_by.id]+=1:g[b.added_by.id]=1,g),{});let l=null,u=0;for(const g in a)a[g]>u&&(u=a[g],l=g);return{user:s.value.find(g=>g.id===l),tracksCount:u}}),m=T(()=>{const a=e.value.reduce((g,b)=>(g[b.added_by.id]?g[b.added_by.id]+=1:g[b.added_by.id]=1,g),{});let l=null,u=1/0;for(const g in a)a[g]<u&&(u=a[g],l=g);return{user:s.value.find(g=>g.id===l),tracksCount:u}}),h=T(()=>{let a="",l=null;return e.value.forEach(u=>{u.track.duration_ms>(l?l.track.duration_ms:0)&&(l=u,a=u.added_by.id)}),{user:s.value.find(u=>u.id===a),track:l}}),y=T(()=>{let a="",l=null;return e.value.forEach(u=>{u.track.duration_ms<(l?l.track.duration_ms:1/0)&&(l=u,a=u.added_by.id)}),{user:s.value.find(u=>u.id===a),track:l}});return{getDisplayNameById:n,getTracksCountByUserId:i,getTotalTrackDurationByUserId:o,getTracksDurationInPercentageByUserId:d,getTotalPlaylistDuration:r,getAverageTrackPopularityByUserId:f,getUserIdWithMostTracks:_,getUserIdWithLeastTracks:m,getUserIdWithLongestTrack:h,getUserIdWithShortestTrack:y}},L=()=>({msToTime:s=>{if(typeof s!="number")return"00h 00m 00s";const r=Math.floor(s/1e3%60),n=Math.floor(s/(1e3*60)%60),i=Math.floor(s/(1e3*60*60)),o=d=>d<10?`0${d}`:d;return`${o(i)}h ${o(n)}m ${o(r)}s`},msToTimeShort:s=>{if(typeof s!="number")return"00:00";const r=Math.floor(s/1e3%60),n=Math.floor(s/(1e3*60)),i=o=>o<10?`0${o}`:o;return`${i(n)}:${i(r)}`}}),_e={key:0,class:"container mx-auto w-100% flex flex-col items-center mt-24 gap-8"},ve=["src"],ke=S({__name:"PlaylistInfo",setup(e){const{playlist:t,playlistInfo:s,usersData:r}=D(),{getTotalPlaylistDuration:n}=z(),{msToTime:i}=L();return(o,d)=>c(s)?(k(),w("div",_e,[c(s).images&&c(s).images.length>0?(k(),w("img",{key:0,src:c(s).images[0].url,alt:"Playlist cover image",width:"300",height:"300"},null,8,ve)):$("",!0),p("h1",null,v(c(s).name)+" "+v(c(i)(c(n)())),1),p("h2",null,v(c(s).description),1)])):$("",!0)}}),we={key:0,class:"flex flex-col items-center gap-1 border-gray/20 border-solid border-rounded-xl p-4"},be=["src"],Te={key:1,class:"w-60px h-60px bg-gray rounded-full"},Ie={class:"mt-2"},$e={class:"opacity-80"},xe={class:"opacity-80"},Se={class:"opacity-80"},De={class:"opacity-80"},ze=S({__name:"UserPanel",props:{userData:Object},setup(e){const t=e,{getTotalTrackDurationByUserId:s,getTracksCountByUserId:r,getTracksDurationInPercentageByUserId:n,getAverageTrackPopularityByUserId:i}=z(),{msToTime:o}=L(),d=t.userData.id,f=r(d),_=n(d),m=s(d),h=i(d),y=T(()=>o(m));return(a,l)=>{var u,g;return e.userData?(k(),w("div",we,[e.userData.images&&e.userData.images.length>0?(k(),w("img",{key:0,class:"rounded-full",src:e.userData.images[0].url,alt:"User profile image",width:"60",height:"60"},null,8,be)):(k(),w("div",Te)),p("div",Ie,v(e.userData.display_name),1),p("div",$e,v(c(f)),1),p("div",xe,v(c(y)),1),p("div",Se,v((u=c(_))==null?void 0:u.toFixed(2))+" % Playtime",1),p("div",De,v((g=c(h))==null?void 0:g.toFixed(0))+" popularity",1)])):$("",!0)}}}),Pe=p("div",{class:"container mx-auto"},[p("h2",null,"Teilnehmer")],-1),Ue={class:"container mx-auto grid grid-cols-2 md:grid-cols-3 xl:grid-cols-6 gap-4 py-8"},Ae=p("h2",{class:"container mx-auto"},"Awards:",-1),Be={class:"container mx-auto grid grid-cols-2 lg:grid-cols-4 gap-4"},We={key:0,class:"border-gray/40 border-solid border-rounded-xl p-2"},Me=p("h3",null,"Most Tracks:",-1),Ne={key:1,class:"border-gray/40 border-solid border-rounded-xl p-2"},Le=p("h3",null,"Least Tracks:",-1),je={key:2,class:"border-gray/40 border-solid border-rounded-xl p-2"},Ee=p("h3",null,"Longest Track:",-1),Ce={key:3,class:"border-gray/40 border-solid border-rounded-xl p-2"},Oe=p("h3",null,"Shortest Track:",-1),qe=S({__name:"Users",setup(e){const{usersData:t}=D(),{getDisplayNameById:s,getUserIdWithMostTracks:r,getUserIdWithLeastTracks:n,getUserIdWithLongestTrack:i,getUserIdWithShortestTrack:o}=z(),{msToTime:d,msToTimeShort:f}=L();return(_,m)=>{var y,a,l,u,g,b,j,E,C,O,q,F,R,H,G,J,V,Q;const h=ze;return k(),w(M,null,[Pe,p("div",Ue,[(k(!0),w(M,null,ee(c(t),(ie,ne)=>(k(),te(h,{key:ne,"user-data":ie},null,8,["user-data"]))),128))]),Ae,p("div",Be,[c(r)&&c(r).tracksCount&&c(r).user&&c(r).user.id?(k(),w("div",We,[Me,p("p",null,v(c(r)?c(s)(c(r).user.id):"No user found")+" with: "+v(c(r).tracksCount)+" tracks ",1)])):$("",!0),c(n)&&c(n).tracksCount&&c(n).user&&c(n).user.id?(k(),w("div",Ne,[Le,p("p",null,v(c(n)?c(s)(c(n).user.id):"No user found")+" with: "+v(c(n).tracksCount)+" tracks ",1)])):$("",!0),c(i)&&c(i).track&&c(i).user&&c(i).user.id?(k(),w("div",je,[Ee,p("p",null,v(c(i)?c(s)(c(i).user.id):"No user found")+" with: "+v(((l=(a=(y=c(i))==null?void 0:y.track)==null?void 0:a.track)==null?void 0:l.name)??"")+" by "+v(((b=(g=(u=c(i))==null?void 0:u.track)==null?void 0:g.track)==null?void 0:b.artists[0].name)??"")+" with: "+v(c(f)((C=(E=(j=c(i))==null?void 0:j.track)==null?void 0:E.track)==null?void 0:C.duration_ms)),1)])):$("",!0),c(o)&&c(o).track&&c(o).user&&c(o).user.id?(k(),w("div",Ce,[Oe,p("p",null,v(c(o)?c(s)(c(o).user.id):"No user found")+" with: "+v(((F=(q=(O=c(o))==null?void 0:O.track)==null?void 0:q.track)==null?void 0:F.name)??"")+" by "+v(((G=(H=(R=c(o))==null?void 0:R.track)==null?void 0:H.track)==null?void 0:G.artists[0].name)??"")+" with: "+v(c(f)((Q=(V=(J=c(o))==null?void 0:J.track)==null?void 0:V.track)==null?void 0:Q.duration_ms)),1)])):$("",!0)])],64)}}});async function Fe(e,t){return await Re(t).catch(r=>(console.error("Failed to get image meta for "+t,r+""),{width:0,height:0,ratio:0}))}async function Re(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,s)=>{const r=new Image;r.onload=()=>{const n={width:r.width,height:r.height,ratio:r.width/r.height};t(n)},r.onerror=n=>s(n),r.src=e})}function Z(e){return t=>t?e[t]||t:e.missingValue}function He({formatter:e,keyMap:t,joinWith:s="/",valueMap:r}={}){e||(e=(i,o)=>`${i}=${o}`),t&&typeof t!="function"&&(t=Z(t));const n=r||{};return Object.keys(n).forEach(i=>{typeof n[i]!="function"&&(n[i]=Z(n[i]))}),(i={})=>Object.entries(i).filter(([d,f])=>typeof f<"u").map(([d,f])=>{const _=n[d];return typeof _=="function"&&(f=_(i[d])),d=typeof t=="function"?t(d):d,e(d,f)}).join(s)}function I(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return parseInt(e,10)}function Ge(e){const t={options:e},s=(n,i={})=>oe(t,n,i),r=(n,i={},o={})=>s(n,{...o,modifiers:se(i,o.modifiers||{})}).url;for(const n in e.presets)r[n]=(i,o,d)=>r(i,o,{...e.presets[n],...d});return r.options=e,r.getImage=s,r.getMeta=(n,i)=>Je(t,n,i),r.getSizes=(n,i)=>Xe(t,n,i),t.$img=r,r}async function Je(e,t,s){const r=oe(e,t,{...s});return typeof r.getMeta=="function"?await r.getMeta():await Fe(e,r.url)}function oe(e,t,s){var _,m;if(typeof t!="string"||t==="")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(t.startsWith("data:"))return{url:t};const{provider:r,defaults:n}=Ve(e,s.provider||e.options.provider),i=Qe(e,s.preset);if(t=X(t)?t:de(t),!r.supportsAlias)for(const h in e.options.alias)t.startsWith(h)&&(t=N(e.options.alias[h],t.substr(h.length)));if(r.validateDomains&&X(t)){const h=le(t).host;if(!e.options.domains.find(y=>y===h))return{url:t}}const o=se(s,i,n);o.modifiers={...o.modifiers};const d=o.modifiers.format;(_=o.modifiers)!=null&&_.width&&(o.modifiers.width=I(o.modifiers.width)),(m=o.modifiers)!=null&&m.height&&(o.modifiers.height=I(o.modifiers.height));const f=r.getImage(t,o,e);return f.format=f.format||d||"",f}function Ve(e,t){const s=e.options.providers[t];if(!s)throw new Error("Unknown provider: "+t);return s}function Qe(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function Xe(e,t,s){var _,m;const r=I((_=s.modifiers)==null?void 0:_.width),n=I((m=s.modifiers)==null?void 0:m.height),i=r&&n?n/r:0,o=[],d={};if(typeof s.sizes=="string")for(const h of s.sizes.split(/[\s,]+/).filter(y=>y)){const y=h.split(":");y.length===2&&(d[y[0].trim()]=y[1].trim())}else Object.assign(d,s.sizes);for(const h in d){const y=e.options.screens&&e.options.screens[h]||parseInt(h);let a=String(d[h]);const l=a.endsWith("vw");if(!l&&/^\d+$/.test(a)&&(a=a+"px"),!l&&!a.endsWith("px"))continue;let u=parseInt(a);if(!y||!u)continue;l&&(u=Math.round(u/100*y));const g=i?Math.round(u*i):n;o.push({width:u,size:a,screenMaxWidth:y,media:`(max-width: ${y}px)`,src:e.$img(t,{...s.modifiers,width:u,height:g},s)})}o.sort((h,y)=>h.screenMaxWidth-y.screenMaxWidth);const f=o[o.length-1];return f&&(f.media=""),{sizes:o.map(h=>`${h.media?h.media+" ":""}${h.size}`).join(", "),srcset:o.map(h=>`${h.src} ${h.width}w`).join(", "),src:f==null?void 0:f.src}}const Ye=He({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,t)=>Y(e)+"_"+Y(t)}),Ze=(e,{modifiers:t={},baseURL:s}={},r)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const n=Ye(t)||"_";return s||(s=N(r.options.nuxt.baseURL,"/_ipx")),{url:N(s,n,ue(e))}},Ke=!0,et=!0,tt=Object.freeze(Object.defineProperty({__proto__:null,getImage:Ze,supportsAlias:et,validateDomains:Ke},Symbol.toStringTag,{value:"Module"})),ae={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipx",domains:[],alias:{}};ae.providers={ipx:{provider:tt,defaults:void 0}};const st=()=>{const e=fe(),t=re();return t.$img||t._img||(t._img=Ge({...ae,nuxt:{baseURL:e.app.baseURL}}))},rt={src:{type:String,required:!0},format:{type:String,default:void 0},quality:{type:[Number,String],default:void 0},background:{type:String,default:void 0},fit:{type:String,default:void 0},modifiers:{type:Object,default:void 0},preset:{type:String,default:void 0},provider:{type:String,default:void 0},sizes:{type:[Object,String],default:void 0},preload:{type:Boolean,default:void 0},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0},alt:{type:String,default:void 0},referrerpolicy:{type:String,default:void 0},usemap:{type:String,default:void 0},longdesc:{type:String,default:void 0},ismap:{type:Boolean,default:void 0},loading:{type:String,default:void 0},crossorigin:{type:[Boolean,String],default:void 0,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,default:void 0,validator:e=>["async","auto","sync"].includes(e)}},ot=e=>{const t=T(()=>({provider:e.provider,preset:e.preset})),s=T(()=>({width:I(e.width),height:I(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding})),r=T(()=>({...e.modifiers,width:I(e.width),height:I(e.height),format:e.format,quality:e.quality,background:e.background,fit:e.fit}));return{options:t,attrs:s,modifiers:r}},at={...rt,placeholder:{type:[Boolean,String,Number,Array],default:void 0}},it=S({name:"NuxtImg",props:at,emits:["load","error"],setup:(e,t)=>{const s=st(),r=ot(e),n=x(!1),i=T(()=>s.getSizes(e.src,{...r.options.value,sizes:e.sizes,modifiers:{...r.modifiers.value,width:I(e.width),height:I(e.height)}})),o=T(()=>{const a={...r.attrs.value,"data-nuxt-img":""};return e.sizes&&(a.sizes=i.value.sizes,a.srcset=i.value.srcset),a}),d=T(()=>{let a=e.placeholder;if(a===""&&(a=!0),!a||n.value)return!1;if(typeof a=="string")return a;const l=Array.isArray(a)?a:typeof a=="number"?[a,a]:[10,10];return s(e.src,{...r.modifiers.value,width:l[0],height:l[1],quality:l[2]||50},r.options.value)}),f=T(()=>e.sizes?i.value.src:s(e.src,r.modifiers.value,r.options.value)),_=T(()=>d.value?d.value:f.value);if(e.preload){const a=Object.values(i.value).every(l=>l);ge({link:[{rel:"preload",as:"image",...a?{href:i.value.src,imagesizes:i.value.sizes,imagesrcset:i.value.srcset}:{href:_.value}}]})}const m=x(),y=re().isHydrating;return he(()=>{if(d.value){const a=new Image;a.src=f.value,a.onload=l=>{m.value&&(m.value.src=f.value),n.value=!0,t.emit("load",l)};return}m.value&&(m.value.complete&&y&&(m.value.getAttribute("data-error")?t.emit("error",new Event("error")):t.emit("load",new Event("load"))),m.value.onload=a=>{t.emit("load",a)},m.value.onerror=a=>{t.emit("error",a)})}),()=>me("img",{ref:m,key:_.value,src:_.value,...o.value,...t.attrs})}}),nt={key:0,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2 md:gap-4 container mx-auto"},ct={class:"px-2 text-white/80 text-xs backdrop-blur-2xl border-solid border-white/20 w-100% md:w-unset"},dt={class:"line-clamp-1"},lt={class:"line-clamp-1"},ut=S({__name:"TrackList",setup(e){const{playlist:t}=D();z();const s=r=>r.map(n=>n.name).join(", ");return(r,n)=>{const i=it;return c(t)?(k(),w("div",nt,[(k(!0),w(M,null,ee(c(t),(o,d)=>(k(),w("div",{key:d,class:"w-100% flex md:flex-col bg-opacity-10"},[o.track.album.images&&o.track.album.images[0]?(k(),te(i,{key:0,src:o.track.album.images[0].url,alt:"cover",loading:"lazy",class:"object-contain w-20 md:w-100% aspect-1/1"},null,8,["src"])):$("",!0),p("div",ct,[p("p",dt,v(o.track.name),1),p("p",lt,v(s(o.track.artists)),1)])]))),128))])):$("",!0)}}}),ft={class:""},gt={class:"py-4"},mt=S({__name:"[playlistId]",setup(e){const s=pe().params.playlistId;return D(s),z(),(r,n)=>{const i=ke,o=qe,d=ut;return k(),w("div",null,[p("div",ft,[U(i),U(o),p("div",gt,[U(d)])])])}}});export{mt as default};
