import{r as U,z as pt,A as N,B as It,i as I,h as P,C as r,o as w,c as T,D as x,a as v,t as m,F as yt,E as _t,G as vt,j as ht,H as $t,I as L,q as xt,J as kt,K as gt,L as St,M as Pt,f as wt,u as Ut,k as Dt,m as zt,N as Wt,b as W}from"./entry.4f630363.js";const At=t=>{const e=U(null),{token:s,getAccessToken:o}=pt(),i=async a=>{const c={method:"get",url:`https://api.spotify.com/v1/users/${t}`,headers:{Authorization:`Bearer ${a}`}};try{const f=await N(c);e.value=f.data}catch(f){console.error("Error getting user data",f)}};return(async()=>{s.value===""&&await o(),i(s.value)})(),{userData:e}},A=U([]),M=U(null),B=U([]),D=(t=null)=>{const{token:e,getAccessToken:s}=pt(),o=async a=>{let c=0,f=null;do{const _={method:"get",url:`https://api.spotify.com/v1/playlists/${t}/tracks?offset=${c}`,headers:{Authorization:`Bearer ${a}`}};try{const y=await N(_);A.value.push(...y.data.items),f=y.data.total,c+=y.data.items.length}catch(y){console.error("Error getting tracks",y)}}while(c<f)},i=async a=>{const c={method:"get",url:`https://api.spotify.com/v1/playlists/${t}`,headers:{Authorization:`Bearer ${a}`}};try{const f=await N(c);M.value=f.data}catch(f){console.error("Error getting playlist information",f)}};return t&&(async()=>{A.value=[],M.value=[],B.value=[],e.value===""&&await s(),i(e.value),await o(e.value);const a=Array.from(new Set(A.value.map(c=>c.added_by.id)));for(let c of a){const{userData:f}=At(c);It(()=>f.value,_=>{_&&B.value.push(_)},{immediate:!0})}})(),{playlist:A,playlistInfo:M,usersData:B}},z=()=>{const{playlist:t,playlistInfo:e,usersData:s}=D(),o=()=>t.value.reduce((u,d)=>u+d.track.duration_ms,0),i=u=>{const d=s.value.find(l=>l.id===u);return d?d.display_name:""},n=u=>t.value.filter(d=>d.added_by.id===u).length,a=u=>t.value.filter(d=>d.added_by.id===u).reduce((d,l)=>d+l.track.duration_ms,0),c=u=>{const d=a(u),l=t.value.reduce((g,$)=>g+$.track.duration_ms,0);return d/l*100},f=u=>{const d=t.value.filter(g=>g.added_by.id===u);return d.length===0?0:d.reduce((g,$)=>g+$.track.popularity,0)/d.length},_=I(()=>{const u=t.value.reduce((g,$)=>(g[$.added_by.id]?g[$.added_by.id]+=1:g[$.added_by.id]=1,g),{});let d=null,l=0;for(const g in u)u[g]>l&&(l=u[g],d=g);return{user:s.value.find(g=>g.id===d),tracksCount:l}}),y=I(()=>{const u=t.value.reduce((g,$)=>(g[$.added_by.id]?g[$.added_by.id]+=1:g[$.added_by.id]=1,g),{});let d=null,l=1/0;for(const g in u)u[g]<l&&(l=u[g],d=g);return{user:s.value.find(g=>g.id===d),tracksCount:l}}),p=I(()=>{let u="",d=null;return t.value.forEach(l=>{l.track.duration_ms>(d?d.track.duration_ms:0)&&(d=l,u=l.added_by.id)}),{user:s.value.find(l=>l.id===u),track:d}}),k=I(()=>{let u="",d=null;return t.value.forEach(l=>{l.track.duration_ms<(d?d.track.duration_ms:1/0)&&(d=l,u=l.added_by.id)}),{user:s.value.find(l=>l.id===u),track:d}}),h=I(()=>{let u="",d=null;return t.value.forEach(l=>{l.track.popularity>(d?d.track.popularity:-1/0)&&(d=l,u=l.added_by.id)}),{user:s.value.find(l=>l.id===u),track:d}}),b=I(()=>{let u="",d=null;return t.value.forEach(l=>{l.track.popularity<(d?d.track.popularity:1/0)&&(d=l,u=l.added_by.id)}),{user:s.value.find(l=>l.id===u),track:d}});return{getDisplayNameById:i,getTracksCountByUserId:n,getTotalTrackDurationByUserId:a,getTracksDurationInPercentageByUserId:c,getTotalPlaylistDuration:o,getAverageTrackPopularityByUserId:f,getUserWithMostTracks:_,getUserIdWithLeastTracks:y,getUserWithLongestTrack:p,getUserWithShortestTrack:k,getUserWithMostPopularTrack:h,getUserWithLeastPopularTrack:b}},j=()=>({msToTime:s=>{if(typeof s!="number")return"00h 00m 00s";const o=Math.floor(s/1e3%60),i=Math.floor(s/(1e3*60)%60),n=Math.floor(s/(1e3*60*60)),a=c=>c<10?`0${c}`:c;return`${a(n)}h ${a(i)}m ${a(o)}s`},msToTimeShort:s=>{if(typeof s!="number")return"00:00";const o=Math.floor(s/1e3%60),i=Math.floor(s/(1e3*60)),n=a=>a<10?`0${a}`:a;return`${n(i)}:${n(o)}`}}),Mt={key:0,class:"container mx-auto w-100% flex flex-col items-center mt-24 gap-8"},Bt=["src"],Nt=P({__name:"PlaylistInfo",setup(t){const{playlist:e,playlistInfo:s,usersData:o}=D(),{getTotalPlaylistDuration:i}=z(),{msToTime:n}=j();return(a,c)=>r(s)?(w(),T("div",Mt,[r(s).images&&r(s).images.length>0?(w(),T("img",{key:0,src:r(s).images[0].url,alt:"Playlist cover image",width:"300",height:"300"},null,8,Bt)):x("",!0),v("h1",null,m(r(s).name)+" "+m(r(n)(r(i)())),1),v("h2",null,m(r(s).description),1)])):x("",!0)}}),Lt={key:0,class:"flex flex-col items-center gap-1 k-border p-4"},jt=["src"],Et={key:1,class:"w-60px h-60px bg-gray rounded-full"},Ct={class:"mt-2"},Ot={class:"opacity-80"},qt={class:"opacity-80"},Ft={class:"opacity-80"},Rt={class:"opacity-80"},Ht=P({__name:"UserPanel",props:{userData:Object},setup(t){const e=t,{getTotalTrackDurationByUserId:s,getTracksCountByUserId:o,getTracksDurationInPercentageByUserId:i,getAverageTrackPopularityByUserId:n}=z(),{msToTime:a}=j(),c=e.userData.id,f=o(c),_=i(c),y=s(c),p=n(c),k=I(()=>a(y));return(h,b)=>{var u,d;return t.userData?(w(),T("div",Lt,[t.userData.images&&t.userData.images.length>0?(w(),T("img",{key:0,class:"rounded-full",src:t.userData.images[0].url,alt:"User profile image",width:"60",height:"60"},null,8,jt)):(w(),T("div",Et)),v("div",Ct,m(t.userData.display_name),1),v("div",Ot,m(r(f)),1),v("div",qt,m(r(k)),1),v("div",Ft,m((u=r(_))==null?void 0:u.toFixed(2))+" % Playtime",1),v("div",Rt,m((d=r(p))==null?void 0:d.toFixed(0))+" popularity",1)])):x("",!0)}}}),Gt={class:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-6 gap-4"},Jt=P({__name:"Users",setup(t){const{usersData:e}=D();return z(),(s,o)=>{const i=Ht;return w(),T("div",Gt,[(w(!0),T(yt,null,_t(r(e),(n,a)=>(w(),vt(i,{key:a,"user-data":n},null,8,["user-data"]))),128))])}}}),Vt={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},Qt={key:0,class:"k-border p-2"},Xt=v("h3",null,"Most Tracks:",-1),Yt={class:"opacity-80"},Zt={key:1,class:"k-border p-2"},Kt=v("h3",null,"Least Tracks:",-1),te={class:"opacity-80"},ee={key:2,class:"k-border p-2"},se=v("h3",null,"Longest Track:",-1),re={class:"opacity-80"},ae={key:3,class:"k-border p-2"},oe=v("h3",null,"Shortest Track:",-1),ie={class:"opacity-80"},ne={key:4,class:"k-border p-2"},ce=v("h3",null,"Mainstream Manfred:",-1),de={class:"opacity-80"},ue={key:5,class:"k-border p-2"},le=v("h3",null,"Underground Uwe:",-1),fe={class:"opacity-80"},he=P({__name:"UserAwards",setup(t){D();const{getDisplayNameById:e,getUserWithMostTracks:s,getUserIdWithLeastTracks:o,getUserWithLongestTrack:i,getUserWithShortestTrack:n,getUserWithMostPopularTrack:a,getUserWithLeastPopularTrack:c}=z(),{msToTime:f,msToTimeShort:_}=j();return(y,p)=>{var k,h,b,u,d,l,g,$,E,C,O,q,F,R,H,G,J,V,Q,X,Y,Z,K,tt,et,st,rt,at,ot,it,nt,ct,dt,ut,lt,ft;return w(),T("div",Vt,[r(s)&&r(s).tracksCount&&r(s).user&&r(s).user.id?(w(),T("div",Qt,[Xt,v("p",Yt,m(r(s)?r(e)(r(s).user.id):"No user found")+" with: "+m(r(s).tracksCount)+" tracks ",1)])):x("",!0),r(o)&&r(o).tracksCount&&r(o).user&&r(o).user.id?(w(),T("div",Zt,[Kt,v("p",te,m(r(o)?r(e)(r(o).user.id):"No user found")+" with: "+m(r(o).tracksCount)+" tracks ",1)])):x("",!0),r(i)&&r(i).track&&r(i).user&&r(i).user.id?(w(),T("div",ee,[se,v("p",re,m(r(i)?r(e)(r(i).user.id):"No user found")+" with: "+m(((b=(h=(k=r(i))==null?void 0:k.track)==null?void 0:h.track)==null?void 0:b.name)??"")+" by "+m(((l=(d=(u=r(i))==null?void 0:u.track)==null?void 0:d.track)==null?void 0:l.artists[0].name)??"")+" with: "+m(r(_)((E=($=(g=r(i))==null?void 0:g.track)==null?void 0:$.track)==null?void 0:E.duration_ms)),1)])):x("",!0),r(n)&&r(n).track&&r(n).user&&r(n).user.id?(w(),T("div",ae,[oe,v("p",ie,m(r(n)?r(e)(r(n).user.id):"No user found")+" with: "+m(((q=(O=(C=r(n))==null?void 0:C.track)==null?void 0:O.track)==null?void 0:q.name)??"")+" by "+m(((H=(R=(F=r(n))==null?void 0:F.track)==null?void 0:R.track)==null?void 0:H.artists[0].name)??"")+" with: "+m(r(_)((V=(J=(G=r(n))==null?void 0:G.track)==null?void 0:J.track)==null?void 0:V.duration_ms)),1)])):x("",!0),r(a)&&r(a).track&&r(a).user&&r(a).user.id?(w(),T("div",ne,[ce,v("p",de,m(r(a)?r(e)(r(a).user.id):"No user found")+" with: "+m(((Y=(X=(Q=r(a))==null?void 0:Q.track)==null?void 0:X.track)==null?void 0:Y.name)??"")+" by "+m(((tt=(K=(Z=r(a))==null?void 0:Z.track)==null?void 0:K.track)==null?void 0:tt.artists[0].name)??"")+" with: "+m((rt=(st=(et=r(a))==null?void 0:et.track)==null?void 0:st.track)==null?void 0:rt.popularity)+" popularity ",1)])):x("",!0),r(c)&&r(c).track&&r(c).user&&r(c).user.id?(w(),T("div",ue,[le,v("p",fe,m(r(c)?r(e)(r(c).user.id):"No user found")+" with: "+m(((it=(ot=(at=r(c))==null?void 0:at.track)==null?void 0:ot.track)==null?void 0:it.name)??"")+" by "+m(((dt=(ct=(nt=r(c))==null?void 0:nt.track)==null?void 0:ct.track)==null?void 0:dt.artists[0].name)??"")+" with: "+m((ft=(lt=(ut=r(c))==null?void 0:ut.track)==null?void 0:lt.track)==null?void 0:ft.popularity)+" popularity ",1)])):x("",!0)])}}});async function ge(t,e){return await me(e).catch(o=>(console.error("Failed to get image meta for "+e,o+""),{width:0,height:0,ratio:0}))}async function me(t){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((e,s)=>{const o=new Image;o.onload=()=>{const i={width:o.width,height:o.height,ratio:o.width/o.height};e(i)},o.onerror=i=>s(i),o.src=t})}function mt(t){return e=>e?t[e]||e:t.missingValue}function pe({formatter:t,keyMap:e,joinWith:s="/",valueMap:o}={}){t||(t=(n,a)=>`${n}=${a}`),e&&typeof e!="function"&&(e=mt(e));const i=o||{};return Object.keys(i).forEach(n=>{typeof i[n]!="function"&&(i[n]=mt(i[n]))}),(n={})=>Object.entries(n).filter(([c,f])=>typeof f<"u").map(([c,f])=>{const _=i[c];return typeof _=="function"&&(f=_(n[c])),c=typeof e=="function"?e(c):c,t(c,f)}).join(s)}function S(t=""){if(typeof t=="number")return t;if(typeof t=="string"&&t.replace("px","").match(/^\d+$/g))return parseInt(t,10)}function ye(t){const e={options:t},s=(i,n={})=>Tt(e,i,n),o=(i,n={},a={})=>s(i,{...a,modifiers:kt(n,a.modifiers||{})}).url;for(const i in t.presets)o[i]=(n,a,c)=>o(n,a,{...t.presets[i],...c});return o.options=t,o.getImage=s,o.getMeta=(i,n)=>_e(e,i,n),o.getSizes=(i,n)=>we(e,i,n),e.$img=o,o}async function _e(t,e,s){const o=Tt(t,e,{...s});return typeof o.getMeta=="function"?await o.getMeta():await ge(t,o.url)}function Tt(t,e,s){var _,y;if(typeof e!="string"||e==="")throw new TypeError(`input must be a string (received ${typeof e}: ${JSON.stringify(e)})`);if(e.startsWith("data:"))return{url:e};const{provider:o,defaults:i}=ve(t,s.provider||t.options.provider),n=ke(t,s.preset);if(e=ht(e)?e:$t(e),!o.supportsAlias)for(const p in t.options.alias)e.startsWith(p)&&(e=L(t.options.alias[p],e.substr(p.length)));if(o.validateDomains&&ht(e)){const p=xt(e).host;if(!t.options.domains.find(k=>k===p))return{url:e}}const a=kt(s,n,i);a.modifiers={...a.modifiers};const c=a.modifiers.format;(_=a.modifiers)!=null&&_.width&&(a.modifiers.width=S(a.modifiers.width)),(y=a.modifiers)!=null&&y.height&&(a.modifiers.height=S(a.modifiers.height));const f=o.getImage(e,a,t);return f.format=f.format||c||"",f}function ve(t,e){const s=t.options.providers[e];if(!s)throw new Error("Unknown provider: "+e);return s}function ke(t,e){if(!e)return{};if(!t.options.presets[e])throw new Error("Unknown preset: "+e);return t.options.presets[e]}function we(t,e,s){var _,y;const o=S((_=s.modifiers)==null?void 0:_.width),i=S((y=s.modifiers)==null?void 0:y.height),n=o&&i?i/o:0,a=[],c={};if(typeof s.sizes=="string")for(const p of s.sizes.split(/[\s,]+/).filter(k=>k)){const k=p.split(":");k.length===2&&(c[k[0].trim()]=k[1].trim())}else Object.assign(c,s.sizes);for(const p in c){const k=t.options.screens&&t.options.screens[p]||parseInt(p);let h=String(c[p]);const b=h.endsWith("vw");if(!b&&/^\d+$/.test(h)&&(h=h+"px"),!b&&!h.endsWith("px"))continue;let u=parseInt(h);if(!k||!u)continue;b&&(u=Math.round(u/100*k));const d=n?Math.round(u*n):i;a.push({width:u,size:h,screenMaxWidth:k,media:`(max-width: ${k}px)`,src:t.$img(e,{...s.modifiers,width:u,height:d},s)})}a.sort((p,k)=>p.screenMaxWidth-k.screenMaxWidth);const f=a[a.length-1];return f&&(f.media=""),{sizes:a.map(p=>`${p.media?p.media+" ":""}${p.size}`).join(", "),srcset:a.map(p=>`${p.src} ${p.width}w`).join(", "),src:f==null?void 0:f.src}}const Te=pe({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(t,e)=>gt(t)+"_"+gt(e)}),be=(t,{modifiers:e={},baseURL:s}={},o)=>{e.width&&e.height&&(e.resize=`${e.width}x${e.height}`,delete e.width,delete e.height);const i=Te(e)||"_";return s||(s=L(o.options.nuxt.baseURL,"/_ipx")),{url:L(s,i,St(t))}},Ie=!0,$e=!0,xe=Object.freeze(Object.defineProperty({__proto__:null,getImage:be,supportsAlias:$e,validateDomains:Ie},Symbol.toStringTag,{value:"Module"})),bt={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipx",domains:[],alias:{}};bt.providers={ipx:{provider:xe,defaults:void 0}};const Se=()=>{const t=Pt(),e=wt();return e.$img||e._img||(e._img=ye({...bt,nuxt:{baseURL:t.app.baseURL}}))},Pe={src:{type:String,required:!0},format:{type:String,default:void 0},quality:{type:[Number,String],default:void 0},background:{type:String,default:void 0},fit:{type:String,default:void 0},modifiers:{type:Object,default:void 0},preset:{type:String,default:void 0},provider:{type:String,default:void 0},sizes:{type:[Object,String],default:void 0},preload:{type:Boolean,default:void 0},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0},alt:{type:String,default:void 0},referrerpolicy:{type:String,default:void 0},usemap:{type:String,default:void 0},longdesc:{type:String,default:void 0},ismap:{type:Boolean,default:void 0},loading:{type:String,default:void 0},crossorigin:{type:[Boolean,String],default:void 0,validator:t=>["anonymous","use-credentials","",!0,!1].includes(t)},decoding:{type:String,default:void 0,validator:t=>["async","auto","sync"].includes(t)}},Ue=t=>{const e=I(()=>({provider:t.provider,preset:t.preset})),s=I(()=>({width:S(t.width),height:S(t.height),alt:t.alt,referrerpolicy:t.referrerpolicy,usemap:t.usemap,longdesc:t.longdesc,ismap:t.ismap,crossorigin:t.crossorigin===!0?"anonymous":t.crossorigin||void 0,loading:t.loading,decoding:t.decoding})),o=I(()=>({...t.modifiers,width:S(t.width),height:S(t.height),format:t.format,quality:t.quality,background:t.background,fit:t.fit}));return{options:e,attrs:s,modifiers:o}},De={...Pe,placeholder:{type:[Boolean,String,Number,Array],default:void 0}},ze=P({name:"NuxtImg",props:De,emits:["load","error"],setup:(t,e)=>{const s=Se(),o=Ue(t),i=U(!1),n=I(()=>s.getSizes(t.src,{...o.options.value,sizes:t.sizes,modifiers:{...o.modifiers.value,width:S(t.width),height:S(t.height)}})),a=I(()=>{const h={...o.attrs.value,"data-nuxt-img":""};return t.sizes&&(h.sizes=n.value.sizes,h.srcset=n.value.srcset),h}),c=I(()=>{let h=t.placeholder;if(h===""&&(h=!0),!h||i.value)return!1;if(typeof h=="string")return h;const b=Array.isArray(h)?h:typeof h=="number"?[h,h]:[10,10];return s(t.src,{...o.modifiers.value,width:b[0],height:b[1],quality:b[2]||50},o.options.value)}),f=I(()=>t.sizes?n.value.src:s(t.src,o.modifiers.value,o.options.value)),_=I(()=>c.value?c.value:f.value);if(t.preload){const h=Object.values(n.value).every(b=>b);Ut({link:[{rel:"preload",as:"image",...h?{href:n.value.src,imagesizes:n.value.sizes,imagesrcset:n.value.srcset}:{href:_.value}}]})}const y=U(),k=wt().isHydrating;return Dt(()=>{if(c.value){const h=new Image;h.src=f.value,h.onload=b=>{y.value&&(y.value.src=f.value),i.value=!0,e.emit("load",b)};return}y.value&&(y.value.complete&&k&&(y.value.getAttribute("data-error")?e.emit("error",new Event("error")):e.emit("load",new Event("load"))),y.value.onload=h=>{e.emit("load",h)},y.value.onerror=h=>{e.emit("error",h)})}),()=>zt("img",{ref:y,key:_.value,src:_.value,...a.value,...e.attrs})}}),We={key:0,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2 md:gap-4 container mx-auto"},Ae={class:"px-2 text-white/80 text-xs backdrop-blur-2xl border-solid border-white/20 w-100% md:w-unset"},Me={class:"line-clamp-1"},Be={class:"line-clamp-1"},Ne=P({__name:"TrackList",setup(t){const{playlist:e}=D();z();const s=o=>o.map(i=>i.name).join(", ");return(o,i)=>{const n=ze;return r(e)?(w(),T("div",We,[(w(!0),T(yt,null,_t(r(e),(a,c)=>(w(),T("div",{key:c,class:"w-100% flex md:flex-col bg-opacity-10"},[a.track.album.images&&a.track.album.images[0]?(w(),vt(n,{key:0,src:a.track.album.images[0].url,alt:"cover",loading:"lazy",class:"object-contain w-20 md:w-100% aspect-1/1"},null,8,["src"])):x("",!0),v("div",Ae,[v("p",Me,m(a.track.name),1),v("p",Be,m(s(a.track.artists)),1)])]))),128))])):x("",!0)}}}),Le={class:""},je={class:"container mx-auto flex flex-col gap-16"},Ce=P({__name:"[playlistId]",setup(t){const s=Wt().params.playlistId;return D(s),z(),(o,i)=>{const n=Nt,a=Jt,c=he,f=Ne;return w(),T("div",null,[v("div",Le,[W(n),v("div",je,[W(a),W(c),W(f)])])])}}});export{Ce as default};
