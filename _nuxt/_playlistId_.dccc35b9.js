import{r as P,f as pe,I as L,h as $e,s as $,g as U,j as r,o as w,c as b,l as S,a as _,t as g,F as ye,k as _e,m as ve,x as me,J as Ie,K as C,C as xe,L as ke,M as fe,N as Se,O as De,n as we,u as Ue,y as Pe,A as ze,b as M,P as Ae}from"./entry.998582b1.js";const Me=e=>{const t=P(null),{token:s,getAccessToken:a}=pe(),c=async o=>{const n={method:"get",url:`https://api.spotify.com/v1/users/${e}`,headers:{Authorization:`Bearer ${o}`}};try{const u=await L(n);t.value=u.data}catch(u){console.error("Error getting user data",u)}};return(async()=>{s.value===""&&await a(),c(s.value)})(),{userData:t}},W=P([]),N=P(null),j=P([]),z=(e=null)=>{const{token:t,getAccessToken:s}=pe(),a=async o=>{let n=0,u=null;do{const v={method:"get",url:`https://api.spotify.com/v1/playlists/${e}/tracks?offset=${n}`,headers:{Authorization:`Bearer ${o}`}};try{const y=await L(v);W.value.push(...y.data.items),u=y.data.total,n+=y.data.items.length}catch(y){console.error("Error getting tracks",y)}}while(n<u)},c=async o=>{const n={method:"get",url:`https://api.spotify.com/v1/playlists/${e}`,headers:{Authorization:`Bearer ${o}`}};try{const u=await L(n);N.value=u.data}catch(u){console.error("Error getting playlist information",u)}};return e&&(async()=>{W.value=[],N.value=[],j.value=[],t.value===""&&await s(),c(t.value),await a(t.value);const o=Array.from(new Set(W.value.map(n=>n.added_by.id)));for(let n of o){const{userData:u}=Me(n);$e(()=>u.value,v=>{v&&j.value.push(v)},{immediate:!0})}})(),{playlist:W,playlistInfo:N,usersData:j}},A=()=>{const{playlist:e,playlistInfo:t,usersData:s}=z(),a=()=>e.value.reduce((h,d)=>h+d.track.duration_ms,0),c=h=>{const d=s.value.find(l=>l.id===h);return d?d.display_name:""},i=h=>{const d=s.value.find(l=>l.id===h);return d||null},o=h=>e.value.filter(d=>d.added_by.id===h).length,n=h=>e.value.filter(d=>d.added_by.id===h).reduce((d,l)=>d+l.track.duration_ms,0),u=h=>{const d=n(h),l=e.value.reduce((p,x)=>p+x.track.duration_ms,0);return d/l*100},v=h=>{const d=e.value.filter(p=>p.added_by.id===h);return d.length===0?0:d.reduce((p,x)=>p+x.track.popularity,0)/d.length},y=$(()=>{const h=e.value.reduce((p,x)=>(p[x.added_by.id]?p[x.added_by.id]+=1:p[x.added_by.id]=1,p),{});let d=null,l=0;for(const p in h)h[p]>l&&(l=h[p],d=p);return{user:s.value.find(p=>p.id===d),tracksCount:l}}),f=$(()=>{const h=e.value.reduce((p,x)=>(p[x.added_by.id]?p[x.added_by.id]+=1:p[x.added_by.id]=1,p),{});let d=null,l=1/0;for(const p in h)h[p]<l&&(l=h[p],d=p);return{user:s.value.find(p=>p.id===d),tracksCount:l}}),k=$(()=>{let h="",d=null;return e.value.forEach(l=>{l.track.duration_ms>(d?d.track.duration_ms:0)&&(d=l,h=l.added_by.id)}),{user:s.value.find(l=>l.id===h),track:d}}),m=$(()=>{let h="",d=null;return e.value.forEach(l=>{l.track.duration_ms<(d?d.track.duration_ms:1/0)&&(d=l,h=l.added_by.id)}),{user:s.value.find(l=>l.id===h),track:d}}),T=$(()=>{let h="",d=null;return e.value.forEach(l=>{l.track.popularity>(d?d.track.popularity:-1/0)&&(d=l,h=l.added_by.id)}),{user:s.value.find(l=>l.id===h),track:d}}),I=$(()=>{let h="",d=null;return e.value.forEach(l=>{l.track.popularity<(d?d.track.popularity:1/0)&&(d=l,h=l.added_by.id)}),{user:s.value.find(l=>l.id===h),track:d}});return{getDisplayNameById:c,getUserById:i,getTracksCountByUserId:o,getTotalTrackDurationByUserId:n,getTracksDurationInPercentageByUserId:u,getTotalPlaylistDuration:a,getAverageTrackPopularityByUserId:v,getUserWithMostTracks:y,getUserIdWithLeastTracks:f,getUserWithLongestTrack:k,getUserWithShortestTrack:m,getUserWithMostPopularTrack:T,getUserWithLeastPopularTrack:I}},B=()=>({msToTime:s=>{if(typeof s!="number")return"00h 00m 00s";const a=Math.floor(s/1e3%60),c=Math.floor(s/(1e3*60)%60),i=Math.floor(s/(1e3*60*60)),o=n=>n<10?`0${n}`:n;return`${o(i)}h ${o(c)}m ${o(a)}s`},msToTimeShort:s=>{if(typeof s!="number")return"00:00";const a=Math.floor(s/1e3%60),c=Math.floor(s/(1e3*60)),i=o=>o<10?`0${o}`:o;return`${i(c)}:${i(a)}`}}),We={key:0,class:"container mx-auto w-100% flex flex-col items-center mt-24 gap-8"},Be=["src"],Ne=U({__name:"PlaylistInfo",setup(e){const{playlist:t,playlistInfo:s,usersData:a}=z(),{getTotalPlaylistDuration:c}=A(),{msToTime:i}=B();return(o,n)=>r(s)?(w(),b("div",We,[r(s).images&&r(s).images.length>0?(w(),b("img",{key:0,src:r(s).images[0].url,alt:"Playlist cover image",width:"300",height:"300"},null,8,Be)):S("",!0),_("h1",null,g(r(s).name)+" "+g(r(i)(r(c)())),1),_("h2",null,g(r(s).description),1)])):S("",!0)}}),je={key:0,class:"flex flex-col items-center gap-1 k-border p-4"},Le=["src"],Ce={key:1,class:"w-60px h-60px rounded-full flex items-center justify-center text-white border-gray/66 border-solid border-2"},Ee={class:"mt-2"},Oe={class:"opacity-80"},Fe={class:"opacity-80"},Re={class:"opacity-80"},qe={class:"opacity-80"},He=U({__name:"UserPanel",props:{userData:Object},setup(e){const t=e,{getTotalTrackDurationByUserId:s,getTracksCountByUserId:a,getTracksDurationInPercentageByUserId:c,getAverageTrackPopularityByUserId:i}=A(),{msToTime:o}=B(),n=t.userData.id,u=a(n),v=c(n),y=s(n),f=i(n),k=$(()=>o(y));return(m,T)=>{var I,h;return e.userData?(w(),b("div",je,[e.userData.images&&e.userData.images.length>0?(w(),b("img",{key:0,class:"rounded-full border-gray/66 border-solid border-2",src:e.userData.images[0].url,alt:"User profile image",width:"60",height:"60"},null,8,Le)):(w(),b("div",Ce,g(e.userData.display_name.slice(0,3)),1)),_("div",Ee,g(e.userData.display_name),1),_("div",Oe,g(r(u)),1),_("div",Fe,g(r(k)),1),_("div",Re,g((I=r(v))==null?void 0:I.toFixed(2))+" % Playtime",1),_("div",qe,g((h=r(f))==null?void 0:h.toFixed(0))+" popularity",1)])):S("",!0)}}}),Je={class:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-6 gap-4"},Ge=U({__name:"Users",setup(e){const{usersData:t}=z();return A(),(s,a)=>{const c=He;return w(),b("div",Je,[(w(!0),b(ye,null,_e(r(t),(i,o)=>(w(),ve(c,{key:o,"user-data":i},null,8,["user-data"]))),128))])}}}),Ve={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},Qe={key:0,class:"k-border p-2"},Xe=_("h3",null,"Most Tracks:",-1),Ye={class:"opacity-80"},Ze={key:1,class:"k-border p-2"},Ke=_("h3",null,"Least Tracks:",-1),et={class:"opacity-80"},tt={key:2,class:"k-border p-2"},st=_("h3",null,"Longest Track:",-1),rt={class:"opacity-80"},at={key:3,class:"k-border p-2"},ot=_("h3",null,"Shortest Track:",-1),it={class:"opacity-80"},nt={key:4,class:"k-border p-2"},ct=_("h3",null,"Mainstream Manfred:",-1),dt={class:"opacity-80"},lt={key:5,class:"k-border p-2"},ut=_("h3",null,"Underground Uwe:",-1),ht={class:"opacity-80"},mt=U({__name:"UserAwards",setup(e){z();const{getDisplayNameById:t,getUserWithMostTracks:s,getUserIdWithLeastTracks:a,getUserWithLongestTrack:c,getUserWithShortestTrack:i,getUserWithMostPopularTrack:o,getUserWithLeastPopularTrack:n}=A(),{msToTime:u,msToTimeShort:v}=B();return(y,f)=>{var k,m,T,I,h,d,l,p,x,E,O,F,R,q,H,J,G,V,Q,X,Y,Z,K,ee,te,se,re,ae,oe,ie,ne,ce,de,le,ue,he;return w(),b("div",Ve,[r(s)&&r(s).tracksCount&&r(s).user&&r(s).user.id?(w(),b("div",Qe,[Xe,_("p",Ye,g(r(s)?r(t)(r(s).user.id):"No user found")+" with: "+g(r(s).tracksCount)+" tracks ",1)])):S("",!0),r(a)&&r(a).tracksCount&&r(a).user&&r(a).user.id?(w(),b("div",Ze,[Ke,_("p",et,g(r(a)?r(t)(r(a).user.id):"No user found")+" with: "+g(r(a).tracksCount)+" tracks ",1)])):S("",!0),r(c)&&r(c).track&&r(c).user&&r(c).user.id?(w(),b("div",tt,[st,_("p",rt,g(r(c)?r(t)(r(c).user.id):"No user found")+" with: "+g(((T=(m=(k=r(c))==null?void 0:k.track)==null?void 0:m.track)==null?void 0:T.name)??"")+" by "+g(((d=(h=(I=r(c))==null?void 0:I.track)==null?void 0:h.track)==null?void 0:d.artists[0].name)??"")+" with: "+g(r(v)((x=(p=(l=r(c))==null?void 0:l.track)==null?void 0:p.track)==null?void 0:x.duration_ms)),1)])):S("",!0),r(i)&&r(i).track&&r(i).user&&r(i).user.id?(w(),b("div",at,[ot,_("p",it,g(r(i)?r(t)(r(i).user.id):"No user found")+" with: "+g(((F=(O=(E=r(i))==null?void 0:E.track)==null?void 0:O.track)==null?void 0:F.name)??"")+" by "+g(((H=(q=(R=r(i))==null?void 0:R.track)==null?void 0:q.track)==null?void 0:H.artists[0].name)??"")+" with: "+g(r(v)((V=(G=(J=r(i))==null?void 0:J.track)==null?void 0:G.track)==null?void 0:V.duration_ms)),1)])):S("",!0),r(o)&&r(o).track&&r(o).user&&r(o).user.id?(w(),b("div",nt,[ct,_("p",dt,g(r(o)?r(t)(r(o).user.id):"No user found")+" with: "+g(((Y=(X=(Q=r(o))==null?void 0:Q.track)==null?void 0:X.track)==null?void 0:Y.name)??"")+" by "+g(((ee=(K=(Z=r(o))==null?void 0:Z.track)==null?void 0:K.track)==null?void 0:ee.artists[0].name)??"")+" with: "+g((re=(se=(te=r(o))==null?void 0:te.track)==null?void 0:se.track)==null?void 0:re.popularity)+" popularity ",1)])):S("",!0),r(n)&&r(n).track&&r(n).user&&r(n).user.id?(w(),b("div",lt,[ut,_("p",ht,g(r(n)?r(t)(r(n).user.id):"No user found")+" with: "+g(((ie=(oe=(ae=r(n))==null?void 0:ae.track)==null?void 0:oe.track)==null?void 0:ie.name)??"")+" by "+g(((de=(ce=(ne=r(n))==null?void 0:ne.track)==null?void 0:ce.track)==null?void 0:de.artists[0].name)??"")+" with: "+g((he=(ue=(le=r(n))==null?void 0:le.track)==null?void 0:ue.track)==null?void 0:he.popularity)+" popularity ",1)])):S("",!0)])}}});async function ft(e,t){return await gt(t).catch(a=>(console.error("Failed to get image meta for "+t,a+""),{width:0,height:0,ratio:0}))}async function gt(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,s)=>{const a=new Image;a.onload=()=>{const c={width:a.width,height:a.height,ratio:a.width/a.height};t(c)},a.onerror=c=>s(c),a.src=e})}function ge(e){return t=>t?e[t]||t:e.missingValue}function pt({formatter:e,keyMap:t,joinWith:s="/",valueMap:a}={}){e||(e=(i,o)=>`${i}=${o}`),t&&typeof t!="function"&&(t=ge(t));const c=a||{};return Object.keys(c).forEach(i=>{typeof c[i]!="function"&&(c[i]=ge(c[i]))}),(i={})=>Object.entries(i).filter(([n,u])=>typeof u<"u").map(([n,u])=>{const v=c[n];return typeof v=="function"&&(u=v(i[n])),n=typeof t=="function"?t(n):n,e(n,u)}).join(s)}function D(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return parseInt(e,10)}function yt(e){const t={options:e},s=(c,i={})=>be(t,c,i),a=(c,i={},o={})=>s(c,{...o,modifiers:ke(i,o.modifiers||{})}).url;for(const c in e.presets)a[c]=(i,o,n)=>a(i,o,{...e.presets[c],...n});return a.options=e,a.getImage=s,a.getMeta=(c,i)=>_t(t,c,i),a.getSizes=(c,i)=>wt(t,c,i),t.$img=a,a}async function _t(e,t,s){const a=be(e,t,{...s});return typeof a.getMeta=="function"?await a.getMeta():await ft(e,a.url)}function be(e,t,s){var v,y;if(typeof t!="string"||t==="")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(t.startsWith("data:"))return{url:t};const{provider:a,defaults:c}=vt(e,s.provider||e.options.provider),i=kt(e,s.preset);if(t=me(t)?t:Ie(t),!a.supportsAlias)for(const f in e.options.alias)t.startsWith(f)&&(t=C(e.options.alias[f],t.substr(f.length)));if(a.validateDomains&&me(t)){const f=xe(t).host;if(!e.options.domains.find(k=>k===f))return{url:t}}const o=ke(s,i,c);o.modifiers={...o.modifiers};const n=o.modifiers.format;(v=o.modifiers)!=null&&v.width&&(o.modifiers.width=D(o.modifiers.width)),(y=o.modifiers)!=null&&y.height&&(o.modifiers.height=D(o.modifiers.height));const u=a.getImage(t,o,e);return u.format=u.format||n||"",u}function vt(e,t){const s=e.options.providers[t];if(!s)throw new Error("Unknown provider: "+t);return s}function kt(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function wt(e,t,s){var v,y;const a=D((v=s.modifiers)==null?void 0:v.width),c=D((y=s.modifiers)==null?void 0:y.height),i=a&&c?c/a:0,o=[],n={};if(typeof s.sizes=="string")for(const f of s.sizes.split(/[\s,]+/).filter(k=>k)){const k=f.split(":");k.length===2&&(n[k[0].trim()]=k[1].trim())}else Object.assign(n,s.sizes);for(const f in n){const k=e.options.screens&&e.options.screens[f]||parseInt(f);let m=String(n[f]);const T=m.endsWith("vw");if(!T&&/^\d+$/.test(m)&&(m=m+"px"),!T&&!m.endsWith("px"))continue;let I=parseInt(m);if(!k||!I)continue;T&&(I=Math.round(I/100*k));const h=i?Math.round(I*i):c;o.push({width:I,size:m,screenMaxWidth:k,media:`(max-width: ${k}px)`,src:e.$img(t,{...s.modifiers,width:I,height:h},s)})}o.sort((f,k)=>f.screenMaxWidth-k.screenMaxWidth);const u=o[o.length-1];return u&&(u.media=""),{sizes:o.map(f=>`${f.media?f.media+" ":""}${f.size}`).join(", "),srcset:o.map(f=>`${f.src} ${f.width}w`).join(", "),src:u==null?void 0:u.src}}const bt=pt({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,t)=>fe(e)+"_"+fe(t)}),Tt=(e,{modifiers:t={},baseURL:s}={},a)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const c=bt(t)||"_";return s||(s=C(a.options.nuxt.baseURL,"/_ipx")),{url:C(s,c,Se(e))}},$t=!0,It=!0,xt=Object.freeze(Object.defineProperty({__proto__:null,getImage:Tt,supportsAlias:It,validateDomains:$t},Symbol.toStringTag,{value:"Module"})),Te={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipx",domains:[],alias:{}};Te.providers={ipx:{provider:xt,defaults:void 0}};const St=()=>{const e=De(),t=we();return t.$img||t._img||(t._img=yt({...Te,nuxt:{baseURL:e.app.baseURL}}))},Dt={src:{type:String,required:!0},format:{type:String,default:void 0},quality:{type:[Number,String],default:void 0},background:{type:String,default:void 0},fit:{type:String,default:void 0},modifiers:{type:Object,default:void 0},preset:{type:String,default:void 0},provider:{type:String,default:void 0},sizes:{type:[Object,String],default:void 0},preload:{type:Boolean,default:void 0},width:{type:[String,Number],default:void 0},height:{type:[String,Number],default:void 0},alt:{type:String,default:void 0},referrerpolicy:{type:String,default:void 0},usemap:{type:String,default:void 0},longdesc:{type:String,default:void 0},ismap:{type:Boolean,default:void 0},loading:{type:String,default:void 0},crossorigin:{type:[Boolean,String],default:void 0,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,default:void 0,validator:e=>["async","auto","sync"].includes(e)}},Ut=e=>{const t=$(()=>({provider:e.provider,preset:e.preset})),s=$(()=>({width:D(e.width),height:D(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding})),a=$(()=>({...e.modifiers,width:D(e.width),height:D(e.height),format:e.format,quality:e.quality,background:e.background,fit:e.fit}));return{options:t,attrs:s,modifiers:a}},Pt={...Dt,placeholder:{type:[Boolean,String,Number,Array],default:void 0}},zt=U({name:"NuxtImg",props:Pt,emits:["load","error"],setup:(e,t)=>{const s=St(),a=Ut(e),c=P(!1),i=$(()=>s.getSizes(e.src,{...a.options.value,sizes:e.sizes,modifiers:{...a.modifiers.value,width:D(e.width),height:D(e.height)}})),o=$(()=>{const m={...a.attrs.value,"data-nuxt-img":""};return e.sizes&&(m.sizes=i.value.sizes,m.srcset=i.value.srcset),m}),n=$(()=>{let m=e.placeholder;if(m===""&&(m=!0),!m||c.value)return!1;if(typeof m=="string")return m;const T=Array.isArray(m)?m:typeof m=="number"?[m,m]:[10,10];return s(e.src,{...a.modifiers.value,width:T[0],height:T[1],quality:T[2]||50},a.options.value)}),u=$(()=>e.sizes?i.value.src:s(e.src,a.modifiers.value,a.options.value)),v=$(()=>n.value?n.value:u.value);if(e.preload){const m=Object.values(i.value).every(T=>T);Ue({link:[{rel:"preload",as:"image",...m?{href:i.value.src,imagesizes:i.value.sizes,imagesrcset:i.value.srcset}:{href:v.value}}]})}const y=P(),k=we().isHydrating;return Pe(()=>{if(n.value){const m=new Image;m.src=u.value,m.onload=T=>{y.value&&(y.value.src=u.value),c.value=!0,t.emit("load",T)};return}y.value&&(y.value.complete&&k&&(y.value.getAttribute("data-error")?t.emit("error",new Event("error")):t.emit("load",new Event("load"))),y.value.onload=m=>{t.emit("load",m)},y.value.onerror=m=>{t.emit("error",m)})}),()=>ze("img",{ref:y,key:v.value,src:v.value,...o.value,...t.attrs})}}),At={key:0},Mt=["src"],Wt={key:1,class:"w-30px h-30px rounded-full flex items-center justify-center text-white border-gray/66 border-solid text-2.25 border-2"},Bt=U({__name:"CircleAvatarSmall",props:{userData:Object},setup(e){return(t,s)=>e.userData?(w(),b("div",At,[e.userData&&e.userData.images&&e.userData.images.length>0?(w(),b("img",{key:0,class:"rounded-full border-gray/66 border-solid",src:e.userData.images[0].url,alt:"User profile image",width:"30",height:"30"},null,8,Mt)):(w(),b("div",Wt,g(e.userData.display_name.slice(0,3)),1))])):S("",!0)}}),Nt={key:0,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4 md:gap-4 container mx-auto"},jt={class:"px-2 text-white/80 text-xs w-100% md:w-unset flex justify-between items-center py-2 gap-2"},Lt={class:"flex flex-col gap-0.66"},Ct={class:"line-clamp-1 my-0"},Et={class:"line-clamp-1 my-0"},Ot={class:"line-clamp-1 my-0"},Ft={class:"line-clamp-1 my-0"},Rt=U({__name:"TrackList",setup(e){const{playlist:t}=z(),{getDisplayNameById:s,getUserById:a}=A(),{msToTime:c,msToTimeShort:i}=B(),o=n=>n.map(u=>u.name).join(", ");return(n,u)=>{const v=zt,y=Bt;return r(t)?(w(),b("div",Nt,[(w(!0),b(ye,null,_e(r(t),(f,k)=>(w(),b("div",{key:k,class:"w-100% flex md:flex-col bg-opacity-10 border-gray/33 hover:border-primary/100 border-solid duration-200"},[f.track.album.images&&f.track.album.images[0]?(w(),ve(v,{key:0,src:f.track.album.images[0].url,alt:"cover",loading:"lazy",class:"object-contain w-20 md:w-100% aspect-1/1"},null,8,["src"])):S("",!0),_("div",jt,[_("div",Lt,[_("p",Ct,g(f.track.name),1),_("p",Et,g(f.track.album.name),1),_("p",Ot,g(o(f.track.artists)),1),_("p",Ft,g(r(i)(f.track.duration_ms)),1)]),M(y,{"user-data":r(a)(f.added_by.id)},null,8,["user-data"])])]))),128))])):S("",!0)}}}),qt={class:""},Ht={class:"container mx-auto flex flex-col gap-16"},Gt=U({__name:"[playlistId]",setup(e){const s=Ae().params.playlistId;return z(s),A(),(a,c)=>{const i=Ne,o=Ge,n=mt,u=Rt;return w(),b("div",null,[_("div",qt,[M(i),_("div",Ht,[M(o),M(n),M(u)])])])}}});export{Gt as default};
